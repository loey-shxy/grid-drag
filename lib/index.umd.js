!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).GridDrag={},e.Vue)}(this,function(e,t){"use strict";const o=24;function n(e,t,n,i){const{width:r,height:s}=n,{gap:a,cellWidth:c}=i;if(console.log(`🔍 查找位置 - 容器宽度: ${r}, 列宽: ${c}, 间距: ${a}`),console.log(`📦 原始组件: ${t.name}, 宽度: ${t.width}, 高度: ${t.height}`),l(t,i),console.log(`📦 填充后组件: ${t.name}, 宽度: ${t.width}, 高度: ${t.height}`),t.width>r)return console.warn("组件宽度超过容器宽度"),null;const d=Math.ceil(t.width/(c+a)),u=Math.min(d,o);console.log(`📏 组件占用列数: ${d} -> ${u}`);const p=new Array(o).fill(0);for(const l of e){const e=Math.floor(l.x/(c+a)),t=Math.ceil(l.width/(c+a)),n=Math.min(e+t,o),i=l.y+l.height+a;console.log(`📍 现有组件: ${l.name}, 位置: (${l.x}, ${l.y}), 尺寸: ${l.width}x${l.height}`),console.log(`📍 占用列: ${e} -> ${n} (${t}列), 底部Y: ${i}`);for(let r=e;r<n;r++)r>=0&&r<o&&(p[r]=Math.max(p[r]||0,i))}console.log("📊 列高度数组:",p.slice(0,12));let m=0,f=1/0;for(let l=0;l<=o-u;l++){let e=0;for(let t=l;t<l+u;t++)e=Math.max(e,p[t]||0);e<f&&(f=e,m=l)}const g=m*(c+a),v=f;if(console.log(`🎯 最佳位置: 列${m}, 高度${f} -> 坐标(${g}, ${v})`),v+t.height>s)return console.warn(`❌ 位置超出容器高度: ${v+t.height} > ${s}`),null;const y={x:parseFloat(g.toFixed(2)),y:parseFloat(v.toFixed(2))},x={width:t.width,height:t.height};for(const o of e)if(h(y,x,{x:o.x,y:o.y},{width:o.width,height:o.height}))return console.warn("新组件位置与现有组件重叠"),null;return y}function i(e,t,n,i,r,l){const{width:s,height:a}=r,{gap:c}=l,d=(s-23*c)/o+c;let h=Math.round(e.x/d);const u=Math.ceil(t.width/d),p=o-u;h=Math.max(0,Math.min(h,p));const m=h*d;let f=e.y;const g=n.filter(o=>{if(o.id===i)return!1;const n=m<o.x+o.width&&m+t.width>o.x,r=o.y+o.height<=e.y;return n&&r});if(g.length>0){let t=null,o=1/0;for(const n of g){const i=e.y-(n.y+n.height);i>=0&&i<o&&(o=i,t=n)}t&&o<=c?(f=t.y+t.height+c,console.log(`高度吸附: 距离=${o}, 吸附到Y=${f}`)):console.log(`不进行高度吸附: 距离=${o} > gap=${c}`)}return f+t.height>a&&(f=a-t.height),f=Math.max(0,f),{x:parseFloat(m.toFixed(2)),y:parseFloat(f.toFixed(2))}}function r(e,t,n,i=!1,r=!1){if(0===e.length)return!0;const{gap:s}=n,a=t.width,c=t.height,d=(a-23*s)/o;if(r){for(const t of e)(t.x+t.width>a||t.y+t.height>c)&&(t.x=Math.min(t.x,a-t.width),t.y=Math.min(t.y,c-t.height),t.x=Math.max(0,t.x),t.y=Math.max(0,t.y));return!0}const h=new Array(o).fill(0);for(const u of e){i||l(u,n);const e=Math.ceil(u.width/(d+s)),t=Math.min(e,o);let r=0,a=1/0;for(let n=0;n<=o-t;n++){let e=0;for(let o=n;o<n+t;o++)e=Math.max(e,h[o]||0);e<a&&(a=e,r=n)}if(u.x=parseFloat((r*(d+s)).toFixed(2)),u.y=parseFloat(a.toFixed(2)),u.y+u.height>c)return console.warn("组件超出容器高度，无法完成布局"),!1;const p=u.y+u.height+s;for(let o=r;o<r+t;o++)h[o]=p}return!0}function l(e,t){const{cellWidth:n,gap:i}=t,r=e.minWidth||n,l=e.minHeight||60;e.width=Math.max(e.width,r),e.height=Math.max(e.height,l);const s=Math.ceil(e.width/(n+i)),a=Math.min(s,o),c=a*n+(a-1)*i;e.width=parseFloat(c.toFixed(2))}function s(e,t,n){const{gap:i,cellWidth:r}=n,l=e.minWidth||r,s=e.minHeight||60,a=Math.max(t.width,l),c=Math.max(t.height,s),d=Math.ceil(a/(r+i)),h=Math.min(d,o),u=h*r+(h-1)*i,p=Math.max(u,l),m=Math.max(c,s);return{width:parseFloat(p.toFixed(2)),height:parseFloat(m.toFixed(2))}}function a(e,t,o,n){const{gap:i}=n;let r=t.y+t.height+i;const l=e.filter(e=>{if(e.id===t.id)return!1;return!(t.x+t.width<=e.x||e.x+e.width<=t.x)});l.sort((e,t)=>e.y-t.y);let s=!1;for(;!s;){s=!0;for(const e of l){if(!(r+t.height<=e.y||e.y+e.height<=r)){r=e.y+e.height+i,s=!1;break}}}return r}function c(e,t,o,n,i,r,l){const s=n.width>t.width,c=n.height>t.height;if(o.x!==t.x||o.y!==t.y){const i={...t,x:o.x,y:o.y,width:n.width,height:n.height};for(const o of e)if(o.id!==t.id&&h({x:i.x,y:i.y},{width:i.width,height:i.height},{x:o.x,y:o.y},{width:o.width,height:o.height}))return{affected:[],canResize:!1};return{affected:[],canResize:!0}}if(s&&("right"===l||l?.includes("right")))return function(e,t,o,n,i,r){const l=[],{width:s,height:c}=i,{gap:d}=r,h={...t,x:o.x,y:o.y,width:n.width,height:n.height},u=e.filter(e=>{if(e.id===t.id)return!1;const o=!(h.y+h.height<=e.y||e.y+e.height<=h.y),n=e.x>=t.x+t.width-d;return o&&n});if(0===u.length)return{affected:[],canResize:!0};u.sort((e,t)=>e.x-t.x);const p=h.x+h.width;let m=!1,f=0;for(const a of u){const e=p+d-a.x;if(e>0){m=!0,f=e;break}}if(!m)return{affected:[],canResize:!0};const g=[],v=[];for(const a of u){const e=a.x+f;e+a.width>s?v.push(a):g.push({...a,x:e,y:a.y})}if(v.length>0){const o=[...e.filter(e=>e.id!==t.id&&!u.some(t=>t.id===e.id)),h,...g];v.sort((e,t)=>e.x-t.x);for(const e of v){const t=a(o,e,0,r);if(t+e.height>c)return{affected:[],canResize:!1};const n={...e,x:e.x,y:t};g.push(n),o.push(n)}}return l.push(...g),{affected:l,canResize:!0}}(e,t,o,n,i,r);if(c&&("bottom"===l||l?.includes("bottom")))return function(e,t,o,n,i,r){const l=[],{height:s}=i,{gap:a}=r,c={...t,x:o.x,y:o.y,width:n.width,height:n.height},d=e.filter(e=>{if(e.id===t.id)return!1;const o=!(c.x+c.width<=e.x||e.x+e.width<=c.x),n=e.y>=t.y+t.height-a;return o&&n});if(0===d.length)return{affected:[],canResize:!0};d.sort((e,t)=>e.y-t.y);const h=c.y+c.height;let u=!1,p=0;for(const m of d){const e=h+a-m.y;if(e>0){u=!0,p=e;break}}if(!u)return{affected:[],canResize:!0};for(const m of d){const e=m.y+p;if(e+m.height>s)return{affected:[],canResize:!1};l.push({...m,x:m.x,y:e})}return{affected:l,canResize:!0}}(e,t,o,n,i,r);{const i={...t,x:o.x,y:o.y,width:n.width,height:n.height};for(const o of e)if(o.id!==t.id&&h({x:i.x,y:i.y},{width:i.width,height:i.height},{x:o.x,y:o.y},{width:o.width,height:o.height}))return{affected:[],canResize:!1};return{affected:[],canResize:!0}}}function d(e,t,o,n,i,r,l){const{width:s,height:a}=i;if(o.x<0||o.y<0||o.x+n.width>s||o.y+n.height>a)return{valid:!1,affectedComponents:[]};const d=e.find(e=>e.id===t);if(!d)return{valid:!1,affectedComponents:[]};const{affected:h,canResize:u}=c(e,d,o,n,i,r,l);return{valid:u,affectedComponents:h}}function h(e,t,o,n){const i=e.x<o.x+n.width&&e.x+t.width>o.x,r=e.y<o.y+n.height&&e.y+t.height>o.y;return i&&r}function u(e,t,o,n,r){const{width:l,height:s}=n,a=e.find(e=>e.id===t);if(!a)return{valid:!1,affectedComponents:[],finalPosition:o};const c={width:a.width,height:a.height},d=i(o,c,e,t,n,r);if(d.x<0||d.y<0||d.x+c.width>l||d.y+c.height>s)return{valid:!1,affectedComponents:[],finalPosition:d};for(const i of e)if(i.id!==t&&h(d,c,{x:i.x,y:i.y},{width:i.width,height:i.height}))return{valid:!1,affectedComponents:[],finalPosition:d};return{valid:!0,affectedComponents:[],finalPosition:d}}const p={class:"resize-overlay"},m=(e,t)=>{const o=e.__vccOpts||e;for(const[n,i]of t)o[n]=i;return o},f=m(t.defineComponent({__name:"GridsterItem",props:{component:{},gridConfig:{},containerInfo:{},allComponents:{}},emits:["resize","drag","remove"],setup(e,{emit:o}){const n=e,i=o,r=t.ref(!1),l=t.ref(!1),a=t.ref(""),c=t.ref({x:0,y:0}),d=t.ref({x:0,y:0}),h=t.computed(()=>({position:"absolute",left:`${n.component.x}px`,top:`${n.component.y}px`,width:`${n.component.width}px`,height:`${n.component.height}px`,zIndex:r.value||l.value?100:1,cursor:l.value?u(a.value):"move"})),u=e=>({top:"n-resize",right:"e-resize",bottom:"s-resize",left:"w-resize","top-left":"nw-resize","top-right":"ne-resize","bottom-left":"sw-resize","bottom-right":"se-resize"}[e]||"move"),m=(e,t)=>{t.preventDefault(),t.stopPropagation(),C(e,t)},f=(e,t)=>{t.preventDefault(),t.stopPropagation(),C(e,t)},g=e=>{r.value=!0,e.dataTransfer?.setData("text/plain",n.component.id),e.dataTransfer.effectAllowed="move";const t=e.currentTarget;e.dataTransfer?.setDragImage(t,0,0);const o=t.getBoundingClientRect();c.value={x:n.component.x,y:n.component.y},d.value={x:e.clientX-o.left,y:e.clientY-o.top}},v=e=>{if(!r.value)return;const t=e.currentTarget.parentElement?.getBoundingClientRect();if(!t)return;const o=e.clientX-t.left-d.value.x,l=e.clientY-t.top-d.value.y;i("drag",n.component.id,{x:o,y:l})},y=()=>{r.value=!1,c.value={x:0,y:0},d.value={x:0,y:0}},x=()=>n.allComponents?n.allComponents.filter(e=>e.id!==n.component.id):[],k=e=>{const t=x(),o=n.gridConfig.gap;for(const i of t){if(!(n.component.y+n.component.height<=i.y||i.y+i.height<=n.component.y)&&i.x+i.width<=n.component.x){if(e-(i.x+i.width)<o)return i.x+i.width+o}}return e},w=e=>{const t=x(),o=n.gridConfig.gap;for(const i of t){if(!(n.component.x+n.component.width<=i.x||i.x+i.width<=n.component.x)&&i.y+i.height<=n.component.y){if(e-(i.y+i.height)<o)return i.y+i.height+o}}return e},C=(e,t)=>{t.preventDefault(),t.stopPropagation();const o=t.clientX,r=t.clientY,c=n.component.width,d=n.component.height,h=n.component.x,u=n.component.y,p=n.containerInfo.width,m=n.containerInfo.height;a.value=e,l.value=!0;const f=t=>{if(0===t.buttons)return void g();const l=t.clientX-o,a=t.clientY-r;let f=c,v=d,y=h,x=u;switch(e){case"right":f=Math.max(n.component.minWidth||100,c+l);break;case"left":f=Math.max(n.component.minWidth||100,c-l),y=h+c-f,y=k(y),f=h+c-y;break;case"bottom":v=Math.max(n.component.minHeight||60,d+a);break;case"top":v=Math.max(n.component.minHeight||60,d-a),x=u+d-v,x=w(x),v=u+d-x;break;case"top-right":f=Math.max(n.component.minWidth||100,c+l),v=Math.max(n.component.minHeight||60,d-a),x=u+d-v,x=w(x),v=u+d-x;break;case"top-left":f=Math.max(n.component.minWidth||100,c-l),v=Math.max(n.component.minHeight||60,d-a),y=h+c-f,x=u+d-v,y=k(y),x=w(x),f=h+c-y,v=u+d-x;break;case"bottom-left":f=Math.max(n.component.minWidth||100,c-l),v=Math.max(n.component.minHeight||60,d+a),y=h+c-f,y=k(y),f=h+c-y;break;case"bottom-right":f=Math.max(n.component.minWidth||100,c+l),v=Math.max(n.component.minHeight||60,d+a)}y=Math.max(0,y),x=Math.max(0,x),y+f>p&&(e.includes("left")?(y=p-f,y=Math.max(0,y)):f=p-y),x+v>m&&(e.includes("top")?(x=m-v,x=Math.max(0,x)):v=m-x),f=Math.max(n.component.minWidth||100,f),v=Math.max(n.component.minHeight||60,v);let C={width:f,height:v};["left","right","top-left","top-right","bottom-left","bottom-right"].includes(e)&&(C=s(n.component,{width:f,height:v},n.gridConfig)),y+C.width>p&&(C.width=p-y),x+C.height>m&&(C.height=m-x),C.width=Math.max(n.component.minWidth||100,C.width),C.height=Math.max(n.component.minHeight||60,C.height),i("resize",n.component.id,{width:parseFloat(C.width.toFixed(2)),height:parseFloat(C.height.toFixed(2)),x:parseFloat(y.toFixed(2)),y:parseFloat(x.toFixed(2)),resizeType:e})},g=()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),document.removeEventListener("mouseleave",g),l.value=!1,a.value=""};document.addEventListener("mousemove",f),document.addEventListener("mouseup",g),document.addEventListener("mouseleave",g),l.value=!0,a.value=""};return(o,n)=>{const i=t.resolveComponent("icon-delete");return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["gridster-item",{resizing:l.value}]),style:t.normalizeStyle(h.value),draggable:"true",onDragstart:g,onDrag:v,onDragend:y},[t.renderSlot(o.$slots,"default",{},void 0,!0),t.createElementVNode("div",p,[t.createElementVNode("div",{class:"edge top",onMousedown:n[0]||(n[0]=e=>m("top",e))},null,32),t.createElementVNode("div",{class:"edge right",onMousedown:n[1]||(n[1]=e=>m("right",e))},null,32),t.createElementVNode("div",{class:"edge bottom",onMousedown:n[2]||(n[2]=e=>m("bottom",e))},null,32),t.createElementVNode("div",{class:"edge left",onMousedown:n[3]||(n[3]=e=>m("left",e))},null,32),t.createElementVNode("div",{class:"corner top-left",onMousedown:n[4]||(n[4]=e=>f("top-left",e))},null,32),t.createElementVNode("div",{class:"corner top-right",onMousedown:n[5]||(n[5]=e=>f("top-right",e))},null,32),t.createElementVNode("div",{class:"corner bottom-left",onMousedown:n[6]||(n[6]=e=>f("bottom-left",e))},null,32),t.createElementVNode("div",{class:"corner bottom-right",onMousedown:n[7]||(n[7]=e=>f("bottom-right",e))},null,32)]),t.createVNode(i,{size:16,class:"remove-btn",onClick:n[8]||(n[8]=t=>o.$emit("remove",e.component.id))})],38)}}}),[["__scopeId","data-v-4ea2d13b"]]),g={class:"add-container"},v={class:"component-library"},y={class:"search-section"},x={class:"components-grid"},k=["onClick"],w={key:0,class:"selection-indicator"},C={key:0,class:"empty-state"},b=m(t.defineComponent({__name:"AddComponent",props:{componentLibrary:{}},emits:["confirm","cancel"],setup(e,{expose:o,emit:n}){const i=e,r=t.ref(!1),l=t.ref([]),s=n,a=t.ref(""),c=t.computed(()=>{if(!a.value)return i.componentLibrary;const e=a.value.toLowerCase();return i.componentLibrary.filter(t=>t.name.toLowerCase().includes(e)||t.type.toLowerCase().includes(e))}),d=e=>l.value.some(t=>t.type===e.type),h=e=>{(e=>{const t=l.value.findIndex(t=>t.type===e.type);t>-1?l.value.splice(t,1):l.value.push(e)})({...e,id:`${e.type}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,x:0,y:0})},u=()=>{l.value.length>0&&(p(),s("confirm",l.value),l.value=[])},p=()=>{r.value=!1};return o({open:()=>{r.value=!0},close:p}),(e,o)=>{const n=t.resolveComponent("a-alert"),i=t.resolveComponent("a-input"),s=t.resolveComponent("a-scrollbar"),m=t.resolveComponent("a-modal");return t.openBlock(),t.createBlock(m,{visible:r.value,"onUpdate:visible":o[1]||(o[1]=e=>r.value=e),title:"添加组件 ",width:"1000px",onOk:u,onCancel:p},{default:t.withCtx(()=>[t.createElementVNode("div",g,[t.createVNode(n,null,{default:t.withCtx(()=>[t.createTextVNode("已选择："+t.toDisplayString(l.value.length),1)]),_:1}),t.createElementVNode("div",v,[t.createElementVNode("div",y,[t.createVNode(i,{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=e=>a.value=e),type:"text",placeholder:"搜索组件...",class:"search-input"},null,8,["modelValue"])]),t.createVNode(s,{style:{height:"500px",overflow:"auto"}},{default:t.withCtx(()=>[t.createElementVNode("div",x,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(c.value,o=>(t.openBlock(),t.createElementBlock("div",{key:o.type,class:t.normalizeClass(["component-card",{selected:d(o)}]),onClick:e=>h(o)},[t.renderSlot(e.$slots,"component",{component:o},void 0,!0),d(o)?(t.openBlock(),t.createElementBlock("div",w," ✓ ")):t.createCommentVNode("",!0)],10,k))),128))])]),_:3}),0===c.value.length?(t.openBlock(),t.createElementBlock("div",C," 未找到匹配的组件 ")):t.createCommentVNode("",!0)])])]),_:3},8,["visible"])}}}),[["__scopeId","data-v-661f7b5e"]]),z=Object.prototype.toString;function $(e){return"[object Number]"===z.call(e)&&e==e}function S(e){return void 0===e}function M(e){return"function"==typeof e}const B=Symbol("ArcoConfigProvider"),N=e=>{var o,n,i;const r=t.getCurrentInstance(),l=t.inject(B,void 0),s=null!=(i=null!=(n=null==l?void 0:l.prefixCls)?n:null==(o=null==r?void 0:r.appContext.config.globalProperties.$arco)?void 0:o.classPrefix)?i:"arco";return e?`${s}-${e}`:s},E=e=>{if(e)return M(e)?e:()=>e};(()=>{try{return!("undefined"!=typeof window&&void 0!==document)}catch(e){return!0}})();var L=(e,t)=>{for(const[o,n]of t)e[o]=n;return e};var V=L(t.defineComponent({name:"IconHover",props:{prefix:{type:String},size:{type:String,default:"medium"},disabled:{type:Boolean,default:!1}},setup:()=>({prefixCls:N("icon-hover")})}),[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("span",{class:t.normalizeClass([e.prefixCls,{[`${e.prefix}-icon-hover`]:e.prefix,[`${e.prefixCls}-size-${e.size}`]:"medium"!==e.size,[`${e.prefixCls}-disabled`]:e.disabled}])},[t.renderSlot(e.$slots,"default")],2)}]]);const j=t.defineComponent({name:"IconClose",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=N("icon");return{cls:t.computed(()=>[n,`${n}-close`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=$(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),I=["stroke-width","stroke-linecap","stroke-linejoin"];var F=L(j,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{d:"M9.857 9.858 24 24m0 0 14.142 14.142M24 24 38.142 9.858M24 24 9.857 38.142"},null,-1)]),14,I)}]]);const _=Object.assign(F,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+F.name,F)}}),W=t.defineComponent({name:"IconInfoCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=N("icon");return{cls:t.computed(()=>[n,`${n}-info-circle-fill`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=$(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),O=["stroke-width","stroke-linecap","stroke-linejoin"];var P=L(W,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm2-30a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2Zm0 17h1a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-6a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1h1v-8a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v11Z",fill:"currentColor",stroke:"none"},null,-1)]),14,O)}]]);const T=Object.assign(P,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+P.name,P)}}),D=t.defineComponent({name:"IconCheckCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=N("icon");return{cls:t.computed(()=>[n,`${n}-check-circle-fill`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=$(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),R=["stroke-width","stroke-linecap","stroke-linejoin"];var H=L(D,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm10.207-24.379a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0L22 26.172l-4.878-4.88a1 1 0 0 0-1.415 0l-1.414 1.415a1 1 0 0 0 0 1.414l7 7a1 1 0 0 0 1.414 0l11.5-11.5Z",fill:"currentColor",stroke:"none"},null,-1)]),14,R)}]]);const A=Object.assign(H,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+H.name,H)}}),G=t.defineComponent({name:"IconExclamationCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=N("icon");return{cls:t.computed(()=>[n,`${n}-exclamation-circle-fill`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=$(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),U=["stroke-width","stroke-linecap","stroke-linejoin"];var Z=L(G,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm-2-11a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v2Zm4-18a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V15Z",fill:"currentColor",stroke:"none"},null,-1)]),14,U)}]]);const q=Object.assign(Z,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+Z.name,Z)}}),Y=t.defineComponent({name:"IconCloseCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=N("icon");return{cls:t.computed(()=>[n,`${n}-close-circle-fill`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=$(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),X=["stroke-width","stroke-linecap","stroke-linejoin"];var J=L(Y,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm4.955-27.771-4.95 4.95-4.95-4.95a1 1 0 0 0-1.414 0l-1.414 1.414a1 1 0 0 0 0 1.414l4.95 4.95-4.95 4.95a1 1 0 0 0 0 1.414l1.414 1.414a1 1 0 0 0 1.414 0l4.95-4.95 4.95 4.95a1 1 0 0 0 1.414 0l1.414-1.414a1 1 0 0 0 0-1.414l-4.95-4.95 4.95-4.95a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0Z",fill:"currentColor",stroke:"none"},null,-1)]),14,X)}]]);const K=Object.assign(J,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+J.name,J)}}),Q=t.defineComponent({name:"IconLoading",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=N("icon");return{cls:t.computed(()=>[n,`${n}-loading`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=$(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),ee=["stroke-width","stroke-linecap","stroke-linejoin"];var te=L(Q,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{d:"M42 24c0 9.941-8.059 18-18 18S6 33.941 6 24 14.059 6 24 6"},null,-1)]),14,ee)}]]);const oe=Object.assign(te,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+te.name,te)}});const ne=new class{constructor(){this.popupStack={popup:new Set,dialog:new Set,message:new Set},this.getNextZIndex=e=>("message"===e?Array.from(this.popupStack.message).pop()||5e3:Array.from(this.popupStack.popup).pop()||1e3)+1,this.add=e=>{const t=this.getNextZIndex(e);return this.popupStack[e].add(t),"dialog"===e&&this.popupStack.popup.add(t),t},this.delete=(e,t)=>{this.popupStack[t].delete(e),"dialog"===t&&this.popupStack.popup.delete(e)},this.isLastDialog=e=>!(this.popupStack.dialog.size>1)||e===Array.from(this.popupStack.dialog).pop()}};var ie=L(t.defineComponent({name:"Message",components:{AIconHover:V,IconInfoCircleFill:T,IconCheckCircleFill:A,IconExclamationCircleFill:q,IconCloseCircleFill:K,IconClose:_,IconLoading:oe},props:{type:{type:String,default:"info"},closable:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!0},duration:{type:Number,default:3e3},resetOnUpdate:{type:Boolean,default:!1},resetOnHover:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:o}){const n=N("message");let i=0;const r=()=>{o("close")},l=()=>{e.duration>0&&(i=window.setTimeout(r,e.duration))},s=()=>{i&&(window.clearTimeout(i),i=0)};t.onMounted(()=>{l()}),t.onUpdated(()=>{e.resetOnUpdate&&(s(),l())}),t.onUnmounted(()=>{s()});return{handleMouseEnter:()=>{e.resetOnHover&&s()},handleMouseLeave:()=>{e.resetOnHover&&l()},prefixCls:n,handleClose:r}}}),[["render",function(e,o,n,i,r,l){const s=t.resolveComponent("icon-info-circle-fill"),a=t.resolveComponent("icon-check-circle-fill"),c=t.resolveComponent("icon-exclamation-circle-fill"),d=t.resolveComponent("icon-close-circle-fill"),h=t.resolveComponent("icon-loading"),u=t.resolveComponent("icon-close"),p=t.resolveComponent("a-icon-hover");return t.openBlock(),t.createElementBlock("li",{role:"alert",class:t.normalizeClass([e.prefixCls,`${e.prefixCls}-${e.type}`,{[`${e.prefixCls}-closable`]:e.closable}]),onMouseenter:o[1]||(o[1]=(...t)=>e.handleMouseEnter&&e.handleMouseEnter(...t)),onMouseleave:o[2]||(o[2]=(...t)=>e.handleMouseLeave&&e.handleMouseLeave(...t))},[e.showIcon&&("normal"!==e.type||e.$slots.icon)?(t.openBlock(),t.createElementBlock("span",{key:0,class:t.normalizeClass(`${e.prefixCls}-icon`)},[t.renderSlot(e.$slots,"icon",{},()=>["info"===e.type?(t.openBlock(),t.createBlock(s,{key:0})):"success"===e.type?(t.openBlock(),t.createBlock(a,{key:1})):"warning"===e.type?(t.openBlock(),t.createBlock(c,{key:2})):"error"===e.type?(t.openBlock(),t.createBlock(d,{key:3})):"loading"===e.type?(t.openBlock(),t.createBlock(h,{key:4})):t.createCommentVNode("v-if",!0)])],2)):t.createCommentVNode("v-if",!0),t.createElementVNode("span",{class:t.normalizeClass(`${e.prefixCls}-content`)},[t.renderSlot(e.$slots,"default")],2),e.closable?(t.openBlock(),t.createElementBlock("span",{key:1,class:t.normalizeClass(`${e.prefixCls}-close-btn`),onClick:o[0]||(o[0]=(...t)=>e.handleClose&&e.handleClose(...t))},[t.createVNode(p,null,{default:t.withCtx(()=>[t.createVNode(u)]),_:1})],2)):t.createCommentVNode("v-if",!0)],34)}]]);var re=t.defineComponent({name:"MessageList",props:{messages:{type:Array,default:()=>[]},position:{type:String,default:"top"}},emits:["close","afterClose"],setup(e,o){const n=N("message-list"),{zIndex:i}=function(e,{visible:o,runOnMounted:n}={}){const i=t.ref(0),r=()=>{i.value=ne.add(e)},l=()=>{ne.delete(i.value,e)};return t.watch(()=>null==o?void 0:o.value,e=>{e?r():l()},{immediate:!0}),n&&(t.onMounted(()=>{r()}),t.onBeforeUnmount(()=>{l()})),{zIndex:t.readonly(i),open:r,close:l,isLastDialog:()=>!1}}("message",{runOnMounted:!0});return()=>{let r;return t.createVNode(t.TransitionGroup,{class:[n,`${n}-${e.position}`],name:"fade-message",tag:"ul",style:{zIndex:i.value},onAfterLeave:()=>o.emit("afterClose")},"function"==typeof(l=r=e.messages.map(e=>{const n={default:E(e.content),icon:E(e.icon)};return t.createVNode(ie,{key:e.id,type:e.type,duration:e.duration,closable:e.closable,resetOnUpdate:e.resetOnUpdate,resetOnHover:e.resetOnHover,onClose:()=>o.emit("close",e.id)},n)}))||"[object Object]"===Object.prototype.toString.call(l)&&!t.isVNode(l)?r:{default:()=>[r]});var l}}});class le{constructor(e,o){this.messageCount=0,this.add=e=>{var o;this.messageCount++;const n=null!=(o=e.id)?o:`__arco_message_${this.messageCount}`;if(this.messageIds.has(n))return this.update(n,e);const i=t.reactive({id:n,...e});return this.messages.value.push(i),this.messageIds.add(n),{close:()=>this.remove(n)}},this.update=(e,t)=>{for(let o=0;o<this.messages.value.length;o++)if(this.messages.value[o].id===e){const n=!S(t.duration);Object.assign(this.messages.value[o],{...t,id:e,resetOnUpdate:n});break}return{close:()=>this.remove(e)}},this.remove=e=>{for(let t=0;t<this.messages.value.length;t++){const o=this.messages.value[t];if(o.id===e){M(o.onClose)&&o.onClose(e),this.messages.value.splice(t,1),this.messageIds.delete(e);break}}},this.clear=()=>{this.messages.value.splice(0)},this.destroy=()=>{0===this.messages.value.length&&this.container&&(t.render(null,this.container),document.body.removeChild(this.container),this.container=null,se[this.position]=void 0)};const{position:n="top"}=e;this.container=(e=>{const t=document.createElement("div");return t.setAttribute("class",`arco-overlay arco-overlay-${e}`),t})("message"),this.messageIds=new Set,this.messages=t.ref([]),this.position=n;const i=t.createVNode(re,{messages:this.messages.value,position:n,onClose:this.remove,onAfterClose:this.destroy});(null!=o?o:de._context)&&(i.appContext=null!=o?o:de._context),t.render(i,this.container),document.body.appendChild(this.container)}}const se={},ae=["info","success","warning","error","loading","normal"],ce=ae.reduce((e,t)=>(e[t]=(e,o)=>{var n;n=e,"[object String]"===z.call(n)&&(e={content:e});const i={type:t,...e},{position:r="top"}=i;return se[r]||(se[r]=new le(i,o)),se[r].add(i)},e),{});ce.clear=e=>{var t;e?null==(t=se[e])||t.clear():Object.values(se).forEach(e=>null==e?void 0:e.clear())};const de={...ce,install:e=>{const t={clear:ce.clear};for(const o of ae)t[o]=(t,n=e._context)=>ce[o](t,n);e.config.globalProperties.$message=t},_context:null},he={class:"grid-header"},ue={class:"grid-header_right"},pe={class:"grid-container"},me=m(t.defineComponent({__name:"GridDrag",props:{componentLibrary:{},addedComponents:{}},emits:["get-container-size","add-component","update:added-components"],setup(e,{emit:i}){const a=e,c=i,h=t.computed({get:()=>a.addedComponents?a.addedComponents:[],set:e=>{c("update:added-components",e)}}),p=t.reactive({gap:10,cellWidth:0}),m=t.reactive({width:0,height:0,scrollTop:0}),g=t.ref(),v=t.computed(()=>m.height),y=t.computed(()=>{const e=p.gap;return{gridTemplateColumns:"repeat(24, minmax(0, 1fr))",gridTemplateRows:"repeat(auto-fit, 100%)",gap:`${e}px`,width:"100%",minHeight:`${v.value}px`}}),x=t.computed(()=>{const e=p.gap;return{gridTemplateColumns:"repeat(24, minmax(0, 1fr))",gap:`${e}px`,gridTemplateRows:"repeat(auto-fit, 100%)",width:"100%"}}),k=()=>{if(!g.value)return;const e=g.value,t=m.width,o=m.height;m.width=e.clientWidth,m.height=e.clientHeight,(()=>{if(!g.value)return;const e=g.value;m.width=e.clientWidth,m.height=e.clientHeight;const t=23*p.gap,o=(m.width-t)/24;p.cellWidth=Math.max(parseFloat(o.toFixed(2)),20)})();const n=m.width>t,i=m.height>o;n||i?(console.log("容器尺寸增加，重新布局"),r(h.value,m,p)):t===m.width&&o===m.height||(console.log("容器尺寸减小，保持原有布局"),r(h.value,m,p,!1,!0))},w=(e,t)=>{const o=h.value.findIndex(t=>t.id===e);if(-1===o)return;const n=h.value[o],i={width:t.width||n.width,height:t.height||n.height},r={x:void 0!==t.x?t.x:n.x,y:void 0!==t.y?t.y:n.y};let l=i;const a=t.resizeType||"";["left","right","top-left","top-right","bottom-left","bottom-right"].includes(a)&&(l=s(n,i,p));const c=d(h.value,e,r,l,m,p,a);if(c.valid)n.x=r.x,n.y=r.y,n.width=l.width,n.height=l.height,c.affectedComponents.length>0&&c.affectedComponents.forEach(e=>{const t=h.value.find(t=>t.id===e.id);t&&(t.x=e.x,t.y=e.y)});else{const t=d(h.value,e,{x:n.x,y:n.y},l,m,p,a);t.valid&&(n.width=l.width,n.height=l.height,t.affectedComponents.length>0&&t.affectedComponents.forEach(e=>{const t=h.value.find(t=>t.id===e.id);t&&(t.x=e.x,t.y=e.y)}))}},C=(e,t)=>{const o=h.value.find(t=>t.id===e);if(!o)return;const n=u(h.value,e,t,m,p);n.valid&&(o.x=n.finalPosition.x,o.y=n.finalPosition.y,n.affectedComponents.length>0&&n.affectedComponents.forEach(e=>{const t=h.value.find(t=>t.id===e.id);t&&(t.x=e.x,t.y=e.y)}))},z=e=>{const t=h.value.findIndex(t=>t.id===e);-1!==t&&h.value.splice(t,1)},$=e=>{e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move")};let S=null;t.onMounted(()=>{g.value&&(S=new ResizeObserver(()=>{k()}),S.observe(g.value)),k(),window.addEventListener("resize",k)}),t.onUnmounted(()=>{S&&S.disconnect(),window.removeEventListener("resize",k)}),t.watch(()=>m,()=>c("get-container-size",m),{deep:!0});const M=t.ref(),B=()=>{M.value.open()},N=e=>{let t=0;const o=[];e.forEach(e=>{const i=n(h.value,e,m,p);if(i){const o={...e,id:`${e.type}-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,x:i.x,y:i.y};l(o,p),h.value.push(o),t++,console.log(`✓ 成功添加: ${e.name} 位置: (${i.x}, ${i.y})`)}else console.warn(`✗ 找不到合适位置: ${e.name}`),o.push(e.name)}),o.length>0?de.warning(`以下组件无法添加（空间不足）：\n${o.join("\n")}`):(t>0&&console.log(`成功添加 ${t} 个组件`),M.value.close())};return(n,i)=>{const r=t.resolveComponent("a-button"),l=t.resolveComponent("a-space");return t.openBlock(),t.createElementBlock(t.Fragment,null,[t.createElementVNode("header",he,[i[1]||(i[1]=t.createElementVNode("div",{class:"grid-header_left"},null,-1)),t.createElementVNode("div",ue,[t.createVNode(l,null,{default:t.withCtx(()=>[t.createVNode(r,{type:"primary",onClick:B},{default:t.withCtx(()=>[...i[0]||(i[0]=[t.createTextVNode("添加组件",-1)])]),_:1}),t.renderSlot(n.$slots,"extra",{},void 0,!0)]),_:3})])]),t.createElementVNode("div",pe,[t.createElementVNode("div",{ref_key:"gridContainer",ref:g,class:"grid-content",style:t.normalizeStyle(y.value),onDragover:$},[t.createElementVNode("div",{class:"grid-background",style:t.normalizeStyle(x.value)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(o),e=>(t.openBlock(),t.createElementBlock("div",{class:"grid-cell",key:e}))),128))],4),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.addedComponents,o=>(t.openBlock(),t.createBlock(f,{key:o.id,component:o,"grid-config":p,"container-info":m,"all-components":e.addedComponents,onResize:w,onDrag:C,onRemove:z},{default:t.withCtx(()=>[t.renderSlot(n.$slots,"item",{itemData:o},void 0,!0)]),_:2},1032,["component","grid-config","container-info","all-components"]))),128))],36)]),t.createVNode(b,{ref_key:"addComponentRef",ref:M,onConfirm:N,"component-library":a.componentLibrary},t.createSlots({_:2},[t.renderList(Object.keys(n.$slots),e=>({name:e,fn:t.withCtx(o=>[t.renderSlot(n.$slots,e,t.normalizeProps(t.guardReactiveProps(o||{})),void 0,!0)])}))]),1032,["component-library"])],64)}}}),[["__scopeId","data-v-87f4fd5c"]]);function fe(e){e.component("GridDrag",me),e.component("GridsterItem",f),e.component("AddComponent",b)}const ge={install:fe,GridDrag:me,GridsterItem:f,AddComponent:b};e.AddComponent=b,e.COLUMNS=o,e.GridDrag=me,e.GridsterItem=f,e.autoFillComponentToGrid=l,e.default=ge,e.findAvailablePosition=n,e.getAffectedComponents=c,e.install=fe,e.reorganizeLayout=r,e.resizeComponentWithAutoFill=s,e.snapToColumnGridWithSmartHeight=i,e.validateDragPosition=u,e.validatePositionWithLayout=d,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map

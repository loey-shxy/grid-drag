!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).GridDrag={},e.Vue)}(this,function(e,t){"use strict";const o=24;function n(e,t){let o=0;e.x+e.width<=t.x?o=t.x-(e.x+e.width):t.x+t.width<=e.x&&(o=e.x-(t.x+t.width));let n=0;return e.y+e.height<=t.y?n=t.y-(e.y+e.height):t.y+t.height<=e.y&&(n=e.y-(t.y+t.height)),0===o&&0===n?0:0===o?n:0===n?o:Math.min(o,n)}function i(e,t,o,i,r){const l={...e,x:t.x,y:t.y,width:o.width,height:o.height};for(const a of i){if(a.id===e.id)continue;if(n(l,a)<=r)return!0}return!1}function r(e,t,n,i){const{width:r,height:l}=n,{gap:a}=i,c=(r-23*a)/o;if(s(t,c,a),t.width>r)return console.warn("组件宽度超过容器宽度"),null;const d=Math.ceil(t.width/c),u=Math.min(d,o),m=new Array(o).fill(0);for(const s of e){const e=c+a,t=Math.floor(s.x/e),n=Math.ceil(s.width/c),i=Math.min(t+n,o),r=s.y+s.height+a;for(let l=t;l<i;l++)l>=0&&l<o&&(m[l]=Math.max(m[l]||0,r))}let h=0,f=1/0;for(let s=0;s<=o-u;s++){let e=0;for(let t=s;t<s+u;t++)e=Math.max(e,m[t]||0);e<f&&(f=e,h=s)}const g=h*(c+a),v=f;if(v+t.height>l)return console.warn("位置超出容器高度"),null;const y={x:parseFloat(g.toFixed(2)),y:parseFloat(v.toFixed(2))},x={width:t.width,height:t.height};for(const o of e)if(p(y,x,{x:o.x,y:o.y},{width:o.width,height:o.height}))return console.warn("新组件位置与现有组件重叠"),null;return y}function l(e,t,n,i,r,l){const{width:a,height:s}=r,{gap:c}=l,d=(a-23*c)/o+c;let u=Math.round(e.x/d);const p=Math.ceil((t.width+c)/d),m=o-p;u=Math.max(0,Math.min(u,m));const h=u*d;let f=e.y;const g=n.filter(o=>{if(o.id===i)return!1;const n=h<o.x+o.width&&h+t.width>o.x,r=o.y+o.height<=e.y;return n&&r});if(g.length>0){let t=null,o=1/0;for(const n of g){const i=e.y-(n.y+n.height);i>=0&&i<o&&(o=i,t=n)}t&&o<=c?(f=t.y+t.height+c,console.log(`高度吸附: 距离=${o}, 吸附到Y=${f}`)):console.log(`不进行高度吸附: 距离=${o} > gap=${c}`)}return f+t.height>s&&(f=s-t.height),f=Math.max(0,f),{x:parseFloat(h.toFixed(2)),y:parseFloat(f.toFixed(2))}}function a(e,t,n,i=!1,r=!1){if(0===e.length)return!0;const{gap:l}=n,a=t.width,c=t.height,d=(a-23*l)/o;if(r){for(const t of e)(t.x+t.width>a||t.y+t.height>c)&&(t.x=Math.min(t.x,a-t.width),t.y=Math.min(t.y,c-t.height),t.x=Math.max(0,t.x),t.y=Math.max(0,t.y));return!0}const u=new Array(o).fill(0);for(const p of e){i||s(p,d,l);const e=Math.ceil((p.width+l)/(d+l)),t=Math.min(e,o);let n=0,r=1/0;for(let i=0;i<=o-t;i++){let e=0;for(let o=i;o<i+t;o++)e=Math.max(e,u[o]||0);e<r&&(r=e,n=i)}if(p.x=parseFloat((n*(d+l)).toFixed(2)),p.y=parseFloat(r.toFixed(2)),p.y+p.height>c)return console.warn("组件超出容器高度，无法完成布局"),!1;const a=p.y+p.height+l;for(let o=n;o<n+t;o++)u[o]=a}return!0}function s(e,t,n){const i=e.minWidth||t,r=e.minHeight||60;e.width=Math.max(e.width,i),e.height=Math.max(e.height,r);const l=Math.ceil((e.width+n)/(t+n)),a=Math.min(l,o),s=a*t+(a-1)*n;e.width=parseFloat(s.toFixed(2))}function c(e,t,n,i){const{gap:r}=n,l=i?(i-23*r)/o:n.cellWidth,a=e.minWidth||l,s=e.minHeight||60,c=Math.max(t.width,a),d=Math.max(t.height,s),u=Math.ceil((c+r)/(l+r)),p=Math.min(u,o),m=p*l+(p-1)*r,h=Math.max(m,a),f=Math.max(d,s);return{width:parseFloat(h.toFixed(2)),height:parseFloat(f.toFixed(2))}}function d(e,t,o,n,r,l){const s=[];let c=!1;(n.width>t.width||n.height>t.height)&&(c=i(t,o,n,e,l.gap));const d=e.map(e=>e.id===t.id?{...e,...o,...n}:{...e});if(c){if(!a(d,r,l,!0,!1))return{affected:[],canResize:!1};e.forEach(e=>{if(e.id!==t.id){const t=d.find(t=>t.id===e.id);!t||t.x===e.x&&t.y===e.y||s.push({...e,x:t.x,y:t.y})}})}else{if(!a(d,r,l,!0,!0))return{affected:[],canResize:!1}}return{affected:s,canResize:!0}}function u(e,t,o,n,i,r){const{width:l,height:a}=i;if(o.x<0||o.y<0||o.x+n.width>l||o.y+n.height>a)return{valid:!1,affectedComponents:[]};const s=e.find(e=>e.id===t);if(!s)return{valid:!1,affectedComponents:[]};const{affected:c,canResize:u}=d(e,s,o,n,i,r);return{valid:u,affectedComponents:c}}function p(e,t,o,n){const i=e.x<o.x+n.width&&e.x+t.width>o.x,r=e.y<o.y+n.height&&e.y+t.height>o.y;return i&&r}function m(e,t,o,n,r){const{width:s,height:c}=n,d=e.find(e=>e.id===t);if(!d)return{valid:!1,affectedComponents:[],finalPosition:o};const u={width:d.width,height:d.height},m=l(o,u,e,t,n,r);if(m.x<0||m.y<0||m.x+u.width>s||m.y+u.height>c)return{valid:!1,affectedComponents:[],finalPosition:m};for(const i of e)if(i.id!==t&&p(m,u,{x:i.x,y:i.y},{width:i.width,height:i.height}))return{valid:!1,affectedComponents:[],finalPosition:m};if(!i(d,m,u,e,r.gap))return{valid:!0,affectedComponents:[],finalPosition:m};const h={...d,x:m.x,y:m.y},f=e.map(e=>e.id===t?h:{...e});if(!a(f,n,r,!0,!1))return{valid:!1,affectedComponents:[],finalPosition:m};for(let i=0;i<f.length;i++)for(let e=i+1;e<f.length;e++){const t=f[i],o=f[e];if(t&&o&&p({x:t.x,y:t.y},{width:t.width,height:t.height},{x:o.x,y:o.y},{width:o.width,height:o.height}))return{valid:!1,affectedComponents:[],finalPosition:m}}const g=[];return e.forEach(e=>{if(e.id!==t){const t=f.find(t=>t.id===e.id);!t||t.x===e.x&&t.y===e.y||g.push({...e,x:t.x,y:t.y})}}),{valid:!0,affectedComponents:g,finalPosition:m}}const h={class:"resize-overlay"},f=(e,t)=>{const o=e.__vccOpts||e;for(const[n,i]of t)o[n]=i;return o},g=f(t.defineComponent({__name:"GridsterItem",props:{component:{},gridConfig:{},containerInfo:{}},emits:["resize","drag","remove"],setup(e,{emit:o}){const n=e,i=o,r=t.ref(!1),l=t.ref(!1),a=t.ref(""),s=t.ref({x:0,y:0}),d=t.ref({x:0,y:0}),u=t.computed(()=>({position:"absolute",left:`${n.component.x}px`,top:`${n.component.y}px`,width:`${n.component.width}px`,height:`${n.component.height}px`,zIndex:r.value||l.value?100:1,cursor:l.value?p(a.value):"move"})),p=e=>({top:"n-resize",right:"e-resize",bottom:"s-resize",left:"w-resize","top-left":"nw-resize","top-right":"ne-resize","bottom-left":"sw-resize","bottom-right":"se-resize"}[e]||"move"),m=(e,t)=>{t.preventDefault(),t.stopPropagation(),x(e,t)},f=(e,t)=>{t.preventDefault(),t.stopPropagation(),x(e,t)},g=e=>{r.value=!0,e.dataTransfer?.setData("text/plain",n.component.id),e.dataTransfer.effectAllowed="move";const t=e.currentTarget;e.dataTransfer?.setDragImage(t,0,0);const o=t.getBoundingClientRect();s.value={x:n.component.x,y:n.component.y},d.value={x:e.clientX-o.left,y:e.clientY-o.top}},v=e=>{if(!r.value)return;const t=e.currentTarget.parentElement?.getBoundingClientRect();if(!t)return;const o=e.clientX-t.left-d.value.x,l=e.clientY-t.top-d.value.y;i("drag",n.component.id,{x:o,y:l})},y=()=>{r.value=!1,s.value={x:0,y:0},d.value={x:0,y:0}},x=(e,t)=>{t.preventDefault(),t.stopPropagation();const o=t.clientX,r=t.clientY,s=n.component.width,d=n.component.height,u=n.component.x,p=n.component.y,m=n.containerInfo.width,h=n.containerInfo.height;a.value=e,l.value=!0;const f=t=>{if(0===t.buttons)return void g();const l=t.clientX-o,a=t.clientY-r;let f=s,v=d,y=u,x=p;switch(e){case"right":f=Math.max(n.component.minWidth||100,s+l);break;case"left":f=Math.max(n.component.minWidth||100,s-l),y=u+s-f;break;case"bottom":v=Math.max(n.component.minHeight||60,d+a);break;case"top":v=Math.max(n.component.minHeight||60,d-a),x=p+d-v;break;case"top-right":f=Math.max(n.component.minWidth||100,s+l),v=Math.max(n.component.minHeight||60,d-a),x=p+d-v;break;case"top-left":f=Math.max(n.component.minWidth||100,s-l),v=Math.max(n.component.minHeight||60,d-a),y=u+s-f,x=p+d-v;break;case"bottom-left":f=Math.max(n.component.minWidth||100,s-l),v=Math.max(n.component.minHeight||60,d+a),y=u+s-f;break;case"bottom-right":f=Math.max(n.component.minWidth||100,s+l),v=Math.max(n.component.minHeight||60,d+a)}y=Math.max(0,y),x=Math.max(0,x),y+f>m&&(e.includes("left")?(y=m-f,y=Math.max(0,y)):f=m-y),x+v>h&&(e.includes("top")?(x=h-v,x=Math.max(0,x)):v=h-x),f=Math.max(n.component.minWidth||100,f),v=Math.max(n.component.minHeight||60,v);let k={width:f,height:v};["left","right","top-left","top-right","bottom-left","bottom-right"].includes(e)&&(k=c(n.component,{width:f,height:v},n.gridConfig,n.containerInfo.width)),y+k.width>m&&(k.width=m-y),x+k.height>h&&(k.height=h-x),k.width=Math.max(n.component.minWidth||100,k.width),k.height=Math.max(n.component.minHeight||60,k.height),i("resize",n.component.id,{width:parseFloat(k.width.toFixed(2)),height:parseFloat(k.height.toFixed(2)),x:parseFloat(y.toFixed(2)),y:parseFloat(x.toFixed(2)),resizeType:e})},g=()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),document.removeEventListener("mouseleave",g),l.value=!1,a.value=""};document.addEventListener("mousemove",f),document.addEventListener("mouseup",g),document.addEventListener("mouseleave",g),l.value=!0,a.value=""};return(o,n)=>{const i=t.resolveComponent("icon-delete");return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["gridster-item",{resizing:l.value}]),style:t.normalizeStyle(u.value),draggable:"true",onDragstart:g,onDrag:v,onDragend:y},[t.renderSlot(o.$slots,"default",{},void 0,!0),t.createElementVNode("div",h,[t.createElementVNode("div",{class:"edge top",onMousedown:n[0]||(n[0]=e=>m("top",e))},null,32),t.createElementVNode("div",{class:"edge right",onMousedown:n[1]||(n[1]=e=>m("right",e))},null,32),t.createElementVNode("div",{class:"edge bottom",onMousedown:n[2]||(n[2]=e=>m("bottom",e))},null,32),t.createElementVNode("div",{class:"edge left",onMousedown:n[3]||(n[3]=e=>m("left",e))},null,32),t.createElementVNode("div",{class:"corner top-left",onMousedown:n[4]||(n[4]=e=>f("top-left",e))},null,32),t.createElementVNode("div",{class:"corner top-right",onMousedown:n[5]||(n[5]=e=>f("top-right",e))},null,32),t.createElementVNode("div",{class:"corner bottom-left",onMousedown:n[6]||(n[6]=e=>f("bottom-left",e))},null,32),t.createElementVNode("div",{class:"corner bottom-right",onMousedown:n[7]||(n[7]=e=>f("bottom-right",e))},null,32)]),t.createVNode(i,{size:16,class:"remove-btn",onClick:n[8]||(n[8]=t=>o.$emit("remove",e.component.id))})],38)}}}),[["__scopeId","data-v-cbc6ba49"]]),v={class:"add-container"},y={class:"component-library"},x={class:"search-section"},k={class:"components-grid"},w=["onClick"],C={key:0,class:"selection-indicator"},b={key:0,class:"empty-state"},M=f(t.defineComponent({__name:"AddComponent",props:{componentLibrary:{}},emits:["confirm","cancel"],setup(e,{expose:o,emit:n}){const i=e,r=t.ref(!1),l=t.ref([]),a=n,s=t.ref(""),c=t.computed(()=>{if(!s.value)return i.componentLibrary;const e=s.value.toLowerCase();return i.componentLibrary.filter(t=>t.name.toLowerCase().includes(e)||t.type.toLowerCase().includes(e))}),d=e=>l.value.some(t=>t.type===e.type),u=e=>{(e=>{const t=l.value.findIndex(t=>t.type===e.type);t>-1?l.value.splice(t,1):l.value.push(e)})({...e,id:`${e.type}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,x:0,y:0})},p=()=>{l.value.length>0&&(m(),a("confirm",l.value),l.value=[])},m=()=>{r.value=!1};return o({open:()=>{r.value=!0},close:m}),(e,o)=>{const n=t.resolveComponent("a-alert"),i=t.resolveComponent("a-input"),a=t.resolveComponent("a-scrollbar"),h=t.resolveComponent("a-modal");return t.openBlock(),t.createBlock(h,{visible:r.value,"onUpdate:visible":o[1]||(o[1]=e=>r.value=e),title:"添加组件 ",width:"1000px",onOk:p,onCancel:m},{default:t.withCtx(()=>[t.createElementVNode("div",v,[t.createVNode(n,null,{default:t.withCtx(()=>[t.createTextVNode("已选择："+t.toDisplayString(l.value.length),1)]),_:1}),t.createElementVNode("div",y,[t.createElementVNode("div",x,[t.createVNode(i,{modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=e=>s.value=e),type:"text",placeholder:"搜索组件...",class:"search-input"},null,8,["modelValue"])]),t.createVNode(a,{style:{height:"500px",overflow:"auto"}},{default:t.withCtx(()=>[t.createElementVNode("div",k,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(c.value,o=>(t.openBlock(),t.createElementBlock("div",{key:o.type,class:t.normalizeClass(["component-card",{selected:d(o)}]),onClick:e=>u(o)},[t.renderSlot(e.$slots,"component",{component:o},void 0,!0),d(o)?(t.openBlock(),t.createElementBlock("div",C," ✓ ")):t.createCommentVNode("",!0)],10,w))),128))])]),_:3}),0===c.value.length?(t.openBlock(),t.createElementBlock("div",b," 未找到匹配的组件 ")):t.createCommentVNode("",!0)])])]),_:3},8,["visible"])}}}),[["__scopeId","data-v-661f7b5e"]]),z=Object.prototype.toString;function S(e){return"[object Number]"===z.call(e)&&e==e}function $(e){return void 0===e}function B(e){return"function"==typeof e}const N=Symbol("ArcoConfigProvider"),E=e=>{var o,n,i;const r=t.getCurrentInstance(),l=t.inject(N,void 0),a=null!=(i=null!=(n=null==l?void 0:l.prefixCls)?n:null==(o=null==r?void 0:r.appContext.config.globalProperties.$arco)?void 0:o.classPrefix)?i:"arco";return e?`${a}-${e}`:a},L=e=>{if(e)return B(e)?e:()=>e};(()=>{try{return!("undefined"!=typeof window&&void 0!==document)}catch(e){return!0}})();var F=(e,t)=>{for(const[o,n]of t)e[o]=n;return e};var V=F(t.defineComponent({name:"IconHover",props:{prefix:{type:String},size:{type:String,default:"medium"},disabled:{type:Boolean,default:!1}},setup:()=>({prefixCls:E("icon-hover")})}),[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("span",{class:t.normalizeClass([e.prefixCls,{[`${e.prefix}-icon-hover`]:e.prefix,[`${e.prefixCls}-size-${e.size}`]:"medium"!==e.size,[`${e.prefixCls}-disabled`]:e.disabled}])},[t.renderSlot(e.$slots,"default")],2)}]]);const I=t.defineComponent({name:"IconClose",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=E("icon");return{cls:t.computed(()=>[n,`${n}-close`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=S(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),j=["stroke-width","stroke-linecap","stroke-linejoin"];var _=F(I,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{d:"M9.857 9.858 24 24m0 0 14.142 14.142M24 24 38.142 9.858M24 24 9.857 38.142"},null,-1)]),14,j)}]]);const W=Object.assign(_,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+_.name,_)}}),O=t.defineComponent({name:"IconInfoCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=E("icon");return{cls:t.computed(()=>[n,`${n}-info-circle-fill`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=S(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),P=["stroke-width","stroke-linecap","stroke-linejoin"];var T=F(O,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm2-30a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2Zm0 17h1a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-6a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1h1v-8a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v11Z",fill:"currentColor",stroke:"none"},null,-1)]),14,P)}]]);const A=Object.assign(T,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+T.name,T)}}),H=t.defineComponent({name:"IconCheckCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=E("icon");return{cls:t.computed(()=>[n,`${n}-check-circle-fill`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=S(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),D=["stroke-width","stroke-linecap","stroke-linejoin"];var G=F(H,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm10.207-24.379a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0L22 26.172l-4.878-4.88a1 1 0 0 0-1.415 0l-1.414 1.415a1 1 0 0 0 0 1.414l7 7a1 1 0 0 0 1.414 0l11.5-11.5Z",fill:"currentColor",stroke:"none"},null,-1)]),14,D)}]]);const R=Object.assign(G,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+G.name,G)}}),U=t.defineComponent({name:"IconExclamationCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=E("icon");return{cls:t.computed(()=>[n,`${n}-exclamation-circle-fill`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=S(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),Z=["stroke-width","stroke-linecap","stroke-linejoin"];var q=F(U,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm-2-11a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v2Zm4-18a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V15Z",fill:"currentColor",stroke:"none"},null,-1)]),14,Z)}]]);const Y=Object.assign(q,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+q.name,q)}}),X=t.defineComponent({name:"IconCloseCircleFill",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=E("icon");return{cls:t.computed(()=>[n,`${n}-close-circle-fill`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=S(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),J=["stroke-width","stroke-linecap","stroke-linejoin"];var K=F(X,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm4.955-27.771-4.95 4.95-4.95-4.95a1 1 0 0 0-1.414 0l-1.414 1.414a1 1 0 0 0 0 1.414l4.95 4.95-4.95 4.95a1 1 0 0 0 0 1.414l1.414 1.414a1 1 0 0 0 1.414 0l4.95-4.95 4.95 4.95a1 1 0 0 0 1.414 0l1.414-1.414a1 1 0 0 0 0-1.414l-4.95-4.95 4.95-4.95a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0Z",fill:"currentColor",stroke:"none"},null,-1)]),14,J)}]]);const Q=Object.assign(K,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+K.name,K)}}),ee=t.defineComponent({name:"IconLoading",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:o}){const n=E("icon");return{cls:t.computed(()=>[n,`${n}-loading`,{[`${n}-spin`]:e.spin}]),innerStyle:t.computed(()=>{const t={};return e.size&&(t.fontSize=S(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t}),onClick:e=>{o("click",e)}}}}),te=["stroke-width","stroke-linecap","stroke-linejoin"];var oe=F(ee,[["render",function(e,o,n,i,r,l){return t.openBlock(),t.createElementBlock("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:t.normalizeClass(e.cls),style:t.normalizeStyle(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},o[1]||(o[1]=[t.createElementVNode("path",{d:"M42 24c0 9.941-8.059 18-18 18S6 33.941 6 24 14.059 6 24 6"},null,-1)]),14,te)}]]);const ne=Object.assign(oe,{install:(e,t)=>{var o;const n=null!=(o=null==t?void 0:t.iconPrefix)?o:"";e.component(n+oe.name,oe)}});const ie=new class{constructor(){this.popupStack={popup:new Set,dialog:new Set,message:new Set},this.getNextZIndex=e=>("message"===e?Array.from(this.popupStack.message).pop()||5e3:Array.from(this.popupStack.popup).pop()||1e3)+1,this.add=e=>{const t=this.getNextZIndex(e);return this.popupStack[e].add(t),"dialog"===e&&this.popupStack.popup.add(t),t},this.delete=(e,t)=>{this.popupStack[t].delete(e),"dialog"===t&&this.popupStack.popup.delete(e)},this.isLastDialog=e=>!(this.popupStack.dialog.size>1)||e===Array.from(this.popupStack.dialog).pop()}};var re=F(t.defineComponent({name:"Message",components:{AIconHover:V,IconInfoCircleFill:A,IconCheckCircleFill:R,IconExclamationCircleFill:Y,IconCloseCircleFill:Q,IconClose:W,IconLoading:ne},props:{type:{type:String,default:"info"},closable:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!0},duration:{type:Number,default:3e3},resetOnUpdate:{type:Boolean,default:!1},resetOnHover:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:o}){const n=E("message");let i=0;const r=()=>{o("close")},l=()=>{e.duration>0&&(i=window.setTimeout(r,e.duration))},a=()=>{i&&(window.clearTimeout(i),i=0)};t.onMounted(()=>{l()}),t.onUpdated(()=>{e.resetOnUpdate&&(a(),l())}),t.onUnmounted(()=>{a()});return{handleMouseEnter:()=>{e.resetOnHover&&a()},handleMouseLeave:()=>{e.resetOnHover&&l()},prefixCls:n,handleClose:r}}}),[["render",function(e,o,n,i,r,l){const a=t.resolveComponent("icon-info-circle-fill"),s=t.resolveComponent("icon-check-circle-fill"),c=t.resolveComponent("icon-exclamation-circle-fill"),d=t.resolveComponent("icon-close-circle-fill"),u=t.resolveComponent("icon-loading"),p=t.resolveComponent("icon-close"),m=t.resolveComponent("a-icon-hover");return t.openBlock(),t.createElementBlock("li",{role:"alert",class:t.normalizeClass([e.prefixCls,`${e.prefixCls}-${e.type}`,{[`${e.prefixCls}-closable`]:e.closable}]),onMouseenter:o[1]||(o[1]=(...t)=>e.handleMouseEnter&&e.handleMouseEnter(...t)),onMouseleave:o[2]||(o[2]=(...t)=>e.handleMouseLeave&&e.handleMouseLeave(...t))},[e.showIcon&&("normal"!==e.type||e.$slots.icon)?(t.openBlock(),t.createElementBlock("span",{key:0,class:t.normalizeClass(`${e.prefixCls}-icon`)},[t.renderSlot(e.$slots,"icon",{},()=>["info"===e.type?(t.openBlock(),t.createBlock(a,{key:0})):"success"===e.type?(t.openBlock(),t.createBlock(s,{key:1})):"warning"===e.type?(t.openBlock(),t.createBlock(c,{key:2})):"error"===e.type?(t.openBlock(),t.createBlock(d,{key:3})):"loading"===e.type?(t.openBlock(),t.createBlock(u,{key:4})):t.createCommentVNode("v-if",!0)])],2)):t.createCommentVNode("v-if",!0),t.createElementVNode("span",{class:t.normalizeClass(`${e.prefixCls}-content`)},[t.renderSlot(e.$slots,"default")],2),e.closable?(t.openBlock(),t.createElementBlock("span",{key:1,class:t.normalizeClass(`${e.prefixCls}-close-btn`),onClick:o[0]||(o[0]=(...t)=>e.handleClose&&e.handleClose(...t))},[t.createVNode(m,null,{default:t.withCtx(()=>[t.createVNode(p)]),_:1})],2)):t.createCommentVNode("v-if",!0)],34)}]]);var le=t.defineComponent({name:"MessageList",props:{messages:{type:Array,default:()=>[]},position:{type:String,default:"top"}},emits:["close","afterClose"],setup(e,o){const n=E("message-list"),{zIndex:i}=function(e,{visible:o,runOnMounted:n}={}){const i=t.ref(0),r=()=>{i.value=ie.add(e)},l=()=>{ie.delete(i.value,e)};return t.watch(()=>null==o?void 0:o.value,e=>{e?r():l()},{immediate:!0}),n&&(t.onMounted(()=>{r()}),t.onBeforeUnmount(()=>{l()})),{zIndex:t.readonly(i),open:r,close:l,isLastDialog:()=>!1}}("message",{runOnMounted:!0});return()=>{let r;return t.createVNode(t.TransitionGroup,{class:[n,`${n}-${e.position}`],name:"fade-message",tag:"ul",style:{zIndex:i.value},onAfterLeave:()=>o.emit("afterClose")},"function"==typeof(l=r=e.messages.map(e=>{const n={default:L(e.content),icon:L(e.icon)};return t.createVNode(re,{key:e.id,type:e.type,duration:e.duration,closable:e.closable,resetOnUpdate:e.resetOnUpdate,resetOnHover:e.resetOnHover,onClose:()=>o.emit("close",e.id)},n)}))||"[object Object]"===Object.prototype.toString.call(l)&&!t.isVNode(l)?r:{default:()=>[r]});var l}}});class ae{constructor(e,o){this.messageCount=0,this.add=e=>{var o;this.messageCount++;const n=null!=(o=e.id)?o:`__arco_message_${this.messageCount}`;if(this.messageIds.has(n))return this.update(n,e);const i=t.reactive({id:n,...e});return this.messages.value.push(i),this.messageIds.add(n),{close:()=>this.remove(n)}},this.update=(e,t)=>{for(let o=0;o<this.messages.value.length;o++)if(this.messages.value[o].id===e){const n=!$(t.duration);Object.assign(this.messages.value[o],{...t,id:e,resetOnUpdate:n});break}return{close:()=>this.remove(e)}},this.remove=e=>{for(let t=0;t<this.messages.value.length;t++){const o=this.messages.value[t];if(o.id===e){B(o.onClose)&&o.onClose(e),this.messages.value.splice(t,1),this.messageIds.delete(e);break}}},this.clear=()=>{this.messages.value.splice(0)},this.destroy=()=>{0===this.messages.value.length&&this.container&&(t.render(null,this.container),document.body.removeChild(this.container),this.container=null,se[this.position]=void 0)};const{position:n="top"}=e;this.container=(e=>{const t=document.createElement("div");return t.setAttribute("class",`arco-overlay arco-overlay-${e}`),t})("message"),this.messageIds=new Set,this.messages=t.ref([]),this.position=n;const i=t.createVNode(le,{messages:this.messages.value,position:n,onClose:this.remove,onAfterClose:this.destroy});(null!=o?o:ue._context)&&(i.appContext=null!=o?o:ue._context),t.render(i,this.container),document.body.appendChild(this.container)}}const se={},ce=["info","success","warning","error","loading","normal"],de=ce.reduce((e,t)=>(e[t]=(e,o)=>{var n;n=e,"[object String]"===z.call(n)&&(e={content:e});const i={type:t,...e},{position:r="top"}=i;return se[r]||(se[r]=new ae(i,o)),se[r].add(i)},e),{});de.clear=e=>{var t;e?null==(t=se[e])||t.clear():Object.values(se).forEach(e=>null==e?void 0:e.clear())};const ue={...de,install:e=>{const t={clear:de.clear};for(const o of ce)t[o]=(t,n=e._context)=>de[o](t,n);e.config.globalProperties.$message=t},_context:null},pe={class:"grid-header"},me={class:"grid-header_right"},he={class:"grid-container"},fe=f(t.defineComponent({__name:"GridDrag",props:{componentLibrary:{},addedComponents:{}},emits:["get-container-size","add-component","update:added-components"],setup(e,{emit:n}){const i=e,l=n,d=t.computed({get:()=>i.addedComponents?i.addedComponents:[],set:e=>{l("update:added-components",e)}}),p=t.reactive({gap:10,cellWidth:0,cellHeight:80}),h=t.reactive({width:0,height:0,scrollTop:0}),f=t.ref(),v=t.computed(()=>h.height),y=t.computed(()=>{const e=p.gap;return{gridTemplateColumns:"repeat(24, minmax(0, 1fr))",gridTemplateRows:"repeat(auto-fit, 100%)",gap:`${e}px`,width:"100%",minHeight:`${v.value}px`}}),x=t.computed(()=>{const e=p.gap;return{gridTemplateColumns:"repeat(24, minmax(0, 1fr))",gap:`${e}px`,gridTemplateRows:"repeat(auto-fit, 100%)",width:"100%"}}),k=()=>{if(!f.value)return;const e=f.value,t=h.width,o=h.height;h.width=e.clientWidth,h.height=e.clientHeight,(()=>{if(!f.value)return;const e=f.value;h.width=e.clientWidth,h.height=e.clientHeight;const t=23*p.gap,o=(h.width-t)/24;p.cellWidth=Math.max(parseFloat(o.toFixed(2)),20)})();const n=h.width>t,i=h.height>o;n||i?(console.log("容器尺寸增加，重新布局"),a(d.value,h,p)):t===h.width&&o===h.height||(console.log("容器尺寸减小，保持原有布局"),a(d.value,h,p,!1,!0))},w=(e,t)=>{const o=d.value.findIndex(t=>t.id===e);if(-1===o)return;const n=d.value[o],i={width:t.width||n.width,height:t.height||n.height},r={x:void 0!==t.x?t.x:n.x,y:void 0!==t.y?t.y:n.y};let l=i;const a=t.resizeType||"";["left","right","top-left","top-right","bottom-left","bottom-right"].includes(a)&&(l=c(n,i,p,h.width));const s=u(d.value,e,r,l,h,p);if(s.valid)n.x=r.x,n.y=r.y,n.width=l.width,n.height=l.height,s.affectedComponents.length>0&&s.affectedComponents.forEach(e=>{const t=d.value.find(t=>t.id===e.id);t&&(t.x=e.x,t.y=e.y)});else{const t=u(d.value,e,{x:n.x,y:n.y},l,h,p);t.valid&&(n.width=l.width,n.height=l.height,t.affectedComponents.length>0&&t.affectedComponents.forEach(e=>{const t=d.value.find(t=>t.id===e.id);t&&(t.x=e.x,t.y=e.y)}))}},C=(e,t)=>{const o=d.value.find(t=>t.id===e);if(!o)return;const n=m(d.value,e,t,h,p);n.valid&&(o.x=n.finalPosition.x,o.y=n.finalPosition.y,n.affectedComponents.length>0&&n.affectedComponents.forEach(e=>{const t=d.value.find(t=>t.id===e.id);t&&(t.x=e.x,t.y=e.y)}))},b=e=>{const o=d.value.findIndex(t=>t.id===e);-1!==o&&(d.value.splice(o,1),console.log(`已移除组件: ${e}`),t.nextTick(()=>{a(d.value,h,p)}))},z=e=>{e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move")};let S=null;t.onMounted(()=>{f.value&&(S=new ResizeObserver(()=>{k()}),S.observe(f.value)),k(),window.addEventListener("resize",k)}),t.onUnmounted(()=>{S&&S.disconnect(),window.removeEventListener("resize",k)}),t.watch(()=>h,()=>l("get-container-size",h),{deep:!0});const $=t.ref(),B=()=>{$.value.open()},N=e=>{let t=0;const o=[];e.forEach(e=>{const n=r(d.value,e,h,p);if(n){const o={...e,id:`${e.type}-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,x:n.x,y:n.y};s(o,p.cellWidth,p.gap),d.value.push(o),t++,console.log(`✓ 成功添加: ${e.name} 位置: (${n.x}, ${n.y})`)}else console.warn(`✗ 找不到合适位置: ${e.name}`),o.push(e.name)}),o.length>0?ue.warning(`以下组件无法添加（空间不足）：\n${o.join("\n")}`):(t>0&&console.log(`成功添加 ${t} 个组件`),$.value.open())};return(n,r)=>{const l=t.resolveComponent("a-button"),a=t.resolveComponent("a-space");return t.openBlock(),t.createElementBlock(t.Fragment,null,[t.createElementVNode("header",pe,[r[1]||(r[1]=t.createElementVNode("div",{class:"grid-header_left"},null,-1)),t.createElementVNode("div",me,[t.createVNode(a,null,{default:t.withCtx(()=>[t.createVNode(l,{type:"primary",onClick:B},{default:t.withCtx(()=>[...r[0]||(r[0]=[t.createTextVNode("添加组件",-1)])]),_:1}),t.renderSlot(n.$slots,"extra",{},void 0,!0)]),_:3})])]),t.createElementVNode("div",he,[t.createElementVNode("div",{ref_key:"gridContainer",ref:f,class:"grid-content",style:t.normalizeStyle(y.value),onDragover:z},[t.createElementVNode("div",{class:"grid-background",style:t.normalizeStyle(x.value)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(o),e=>(t.openBlock(),t.createElementBlock("div",{class:"grid-cell",key:e}))),128))],4),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.addedComponents,e=>(t.openBlock(),t.createBlock(g,{key:e.id,component:e,"grid-config":p,"container-info":h,onResize:w,onDrag:C,onRemove:b},{default:t.withCtx(()=>[t.renderSlot(n.$slots,"item",{itemData:e},void 0,!0)]),_:2},1032,["component","grid-config","container-info"]))),128))],36)]),t.createVNode(M,{ref_key:"addComponentRef",ref:$,onConfirm:N,"component-library":i.componentLibrary},t.createSlots({_:2},[t.renderList(Object.keys(n.$slots),e=>({name:e,fn:t.withCtx(o=>[t.renderSlot(n.$slots,e,t.normalizeProps(t.guardReactiveProps(o||{})),void 0,!0)])}))]),1032,["component-library"])],64)}}}),[["__scopeId","data-v-3cd88267"]]);function ge(e){e.component("GridDrag",fe),e.component("GridsterItem",g),e.component("AddComponent",M)}const ve={install:ge,GridDrag:fe,GridsterItem:g,AddComponent:M};e.AddComponent=M,e.COLUMNS=o,e.GridDrag=fe,e.GridsterItem=g,e.autoFillComponentToGrid=s,e.calculateAvailableSpace=function(e,t,o){const n=e.reduce((e,t)=>e+t.width*t.height,0),i=t.width*t.height;return{usedArea:n,totalArea:i,availableArea:i-n,utilization:(n/i*100).toFixed(1)+"%"}},e.canAddComponent=function(e,t,o,n){return a([...e,{...t,x:0,y:0}],o,n)},e.default=ve,e.findAvailablePosition=r,e.getAffectedComponents=d,e.install=ge,e.reorganizeLayout=a,e.resizeComponentWithAutoFill=c,e.snapToColumnGrid=function(e,t,n){const{width:i}=t,{gap:r,cellHeight:l}=n,a=(i-23*r)/o+r,s=l+r;let c=Math.round(e.x/a);c=Math.max(0,Math.min(c,23));const d=c*a;let u=Math.round(e.y/s);u=Math.max(0,u);const p=u*s;return{x:parseFloat(d.toFixed(2)),y:parseFloat(p.toFixed(2))}},e.snapToColumnGridWithSize=function(e,t,n,i){const{width:r,height:l}=n,{gap:a}=i,s=(r-23*a)/o+a;let c=Math.round(e.x/s);const d=Math.ceil((t.width+a)/s),u=o-d;c=Math.max(0,Math.min(c,u));const p=c*s;let m=e.y;return m+t.height>l&&(m=l-t.height),m=Math.max(0,m),{x:parseFloat(p.toFixed(2)),y:parseFloat(m.toFixed(2))}},e.snapToColumnGridWithSmartHeight=l,e.snapToGrid=function(e,t){const{cellWidth:o,cellHeight:n,gap:i}=t,r=o+i,l=n+i,a=Math.round(e.x/r)*r,s=Math.round(e.y/l)*l;return{x:parseFloat(a.toFixed(2)),y:parseFloat(s.toFixed(2))}},e.validateDragPosition=m,e.validatePosition=(e,t,o,n,i,r)=>{const{width:l,height:a}=i;if(o.x<0||o.y<0||o.x+n.width>l||o.y+n.height>a)return!1;for(const s of e){if(s.id===t)continue;const e=o.x<s.x+s.width&&o.x+n.width>s.x,i=o.y<s.y+s.height&&o.y+n.height>s.y;if(e&&i)return!1}return!0},e.validatePositionWithLayout=u,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map

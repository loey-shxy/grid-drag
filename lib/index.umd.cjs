(function(t,z){typeof exports=="object"&&typeof module<"u"?module.exports=z(require("vue"),require("@arco-design/web-vue")):typeof define=="function"&&define.amd?define(["vue","@arco-design/web-vue"],z):(t=typeof globalThis<"u"?globalThis:t||self,t.GridDrag=z(t.Vue,t.webVue))})(this,(function(t,z){"use strict";function K(a,n,e,l){const{width:i,height:s}=e,{gap:r,cellWidth:c}=l;if(q(n,l),console.log(`ðŸ“¦ å¡«å……åŽç»„ä»¶: ${n.name}, å®½åº¦: ${n.width}, é«˜åº¦: ${n.height}`),n.width>i)return console.warn("ç»„ä»¶å®½åº¦è¶…è¿‡å®¹å™¨å®½åº¦"),null;const g=Math.ceil(n.width/(c+r)),y=Math.min(g,24);console.log(`ðŸ“ ç»„ä»¶å ç”¨åˆ—æ•°: ${g} -> ${y}`);const h=new Array(24).fill(0);for(const d of a){const x=Math.floor(d.x/(c+r)),H=Math.ceil(d.width/(c+r)),p=Math.min(x+H,24),o=d.y+d.height+r;console.log(`ðŸ“ çŽ°æœ‰ç»„ä»¶: ${d.name}, ä½ç½®: (${d.x}, ${d.y}), å°ºå¯¸: ${d.width}x${d.height}`),console.log(`ðŸ“ å ç”¨åˆ—: ${x} -> ${p} (${H}åˆ—), åº•éƒ¨Y: ${o}`);for(let u=x;u<p;u++)u>=0&&u<24&&(h[u]=Math.max(h[u]||0,o))}console.log("ðŸ“Š åˆ—é«˜åº¦æ•°ç»„:",h.slice(0,12));let m=0,M=1/0;for(let d=0;d<=24-y;d++){let x=0;for(let H=d;H<d+y;H++)x=Math.max(x,h[H]||0);x<M&&(M=x,m=d)}const N=m*(c+r),b=M;if(console.log(`ðŸŽ¯ æœ€ä½³ä½ç½®: åˆ—${m}, é«˜åº¦${M} -> åæ ‡(${N}, ${b})`),b+n.height>s)return console.warn(`âŒ ä½ç½®è¶…å‡ºå®¹å™¨é«˜åº¦: ${b+n.height} > ${s}`),null;const C={x:parseFloat(N.toFixed(3)),y:parseFloat(b.toFixed(3))},_={width:n.width,height:n.height};for(const d of a)if(G(C,_,{x:d.x,y:d.y},{width:d.width,height:d.height}))return console.warn("æ–°ç»„ä»¶ä½ç½®ä¸ŽçŽ°æœ‰ç»„ä»¶é‡å "),null;return C}function Z(a,n,e,l,i,s){const{width:r,height:c}=i,{gap:g}=s,h=(r-23*g)/24+g;let m=Math.round(a.x/h);const N=24-Math.ceil(n.width/h);m=Math.max(0,Math.min(m,N));const b=m*h;let C=a.y;const _=e.filter(d=>{if(d.id===l)return!1;const x=b<d.x+d.width&&b+n.width>d.x,H=d.y+d.height<=a.y;return x&&H});if(_.length>0){let d=null,x=1/0;for(const H of _){const p=a.y-(H.y+H.height);p>=0&&p<x&&(x=p,d=H)}d&&x<=g?(C=d.y+d.height+g,console.log(`é«˜åº¦å¸é™„: è·ç¦»=${x}, å¸é™„åˆ°Y=${C}`)):console.log(`ä¸è¿›è¡Œé«˜åº¦å¸é™„: è·ç¦»=${x} > gap=${g}`)}return C+n.height>c&&(C=c-n.height),C=Math.max(0,C),{x:parseFloat(b.toFixed(3)),y:parseFloat(C.toFixed(3))}}function q(a,n){const{cellWidth:e,gap:l}=n,i=a.minWidth||e,s=a.minHeight||60;a.width=Math.max(a.width,i),a.height=Math.max(a.height,s);const r=Math.ceil(a.width/(e+l)),c=Math.min(r,24),g=c*e+(c-1)*l;a.width=parseFloat(g.toFixed(3))}function j(a,n,e){const{gap:l,cellWidth:i}=e,s=a.minWidth||i,r=a.minHeight||60,c=Math.max(n.width,s),g=Math.max(n.height,r),y=Math.ceil(c/(i+l)),h=Math.min(y,24),m=h*i+(h-1)*l,M=Math.max(m,s),N=Math.max(g,r);return{width:parseFloat(M.toFixed(3)),height:parseFloat(N.toFixed(3))}}function U(a,n,e,l,i,s){const r=[],{width:c,height:g}=i,{gap:y}=s,h={...n,x:e.x,y:e.y,width:l.width,height:l.height},m=a.filter(d=>{if(d.id===n.id)return!1;const x=!(h.y+h.height<=d.y||d.y+d.height<=h.y),H=d.x>=n.x+n.width-y;return x&&H});if(m.length===0)return{affected:[],canResize:!0};m.sort((d,x)=>d.x-x.x);const M=h.x+h.width;let N=!1,b=0;for(const d of m){const x=M+y-d.x;if(x>0){N=!0,b=x;break}}if(!N)return{affected:[],canResize:!0};const C=[],_=[];for(const d of m){const x=d.x+b;x+d.width>c?_.push(d):C.push({...d,x,y:d.y})}if(_.length>0){const d=[...a.filter(x=>x.id!==n.id&&!m.some(H=>H.id===x.id)),h,...C];_.sort((x,H)=>x.x-H.x);for(const x of _){const H=tt(d,x,s);if(H+x.height>g){const p=c-x.width,o={...x,x:p,y:x.y};return C.push(o),d.push(o),{affected:[],canResize:!1}}else{const p={...x,x:x.x,y:H};C.push(p),d.push(p)}}}return r.push(...C),{affected:r,canResize:!0}}function Y(a,n,e,l,i,s){const r=[],{height:c}=i,{gap:g}=s,y={...n,x:e.x,y:e.y,width:l.width,height:l.height},h=a.filter(b=>{if(b.id===n.id)return!1;const C=!(y.x+y.width<=b.x||b.x+b.width<=y.x),_=b.y>=n.y+n.height-g;return C&&_});if(h.length===0)return{affected:[],canResize:!0};h.sort((b,C)=>b.y-C.y);const m=y.y+y.height;let M=!1,N=0;for(const b of h){const C=m+g-b.y;if(C>0){M=!0,N=C;break}}if(!M)return{affected:[],canResize:!0};for(const b of h){const C=b.y+N;if(C+b.height>c)return{affected:[],canResize:!1};r.push({...b,x:parseFloat(b.x.toFixed(3)),y:parseFloat(C.toFixed(3))})}return{affected:r,canResize:!0}}function tt(a,n,e){const{gap:l}=e;let i=n.y+n.height+l;const s=a.filter(c=>c.id===n.id?!1:!(n.x+n.width<=c.x||c.x+c.width<=n.x));s.sort((c,g)=>c.y-g.y);let r=!1;for(;!r;){r=!0;for(const c of s)if(!(i+n.height<=c.y||c.y+c.height<=i)){i=c.y+c.height+l,r=!1;break}}return i}function et(a,n,e,l,i,s){const r=U(a,n,e,l,i,s);if(!r.canResize)return r;const c=a.map(m=>{const M=r.affected.find(N=>N.id===m.id);return M?{...m,x:M.x,y:M.y}:m}),g=Y(c,n,e,l,i,s);if(!g.canResize)return g;const y=[],h=new Set;for(const m of r.affected)y.push(m),h.add(m.id);for(const m of g.affected)if(!h.has(m.id))y.push(m);else{const M=y.find(N=>N.id===m.id);M&&(M.y=m.y)}return{affected:y,canResize:!0}}function ot(a,n,e,l,i,s,r){const c=l.width>n.width,g=l.height>n.height,y=e.x!==n.x||e.y!==n.y;if(y){const h={...n,x:e.x,y:e.y,width:l.width,height:l.height};for(const m of a)if(m.id!==n.id&&G({x:h.x,y:h.y},{width:h.width,height:h.height},{x:m.x,y:m.y},{width:m.width,height:m.height}))return{affected:[],canResize:!1};return{affected:[],canResize:!0}}if(r==="bottom-right"&&c&&g)return et(a,n,e,l,i,s);if(r==="top-right"&&c&&y)return g?U(a,n,e,l,i,s):{affected:[],canResize:!X(a,n,e,l)};if(r==="bottom-left"&&g&&y)return c?Y(a,n,e,l,i,s):{affected:[],canResize:!X(a,n,e,l)};if(r==="top-left"&&y)return{affected:[],canResize:!X(a,n,e,l)};if(c&&(r==="right"||r?.includes("right")))return U(a,n,e,l,i,s);if(g&&(r==="bottom"||r?.includes("bottom")))return Y(a,n,e,l,i,s);{const h={...n,x:e.x,y:e.y,width:l.width,height:l.height};for(const m of a)if(m.id!==n.id&&G({x:h.x,y:h.y},{width:h.width,height:h.height},{x:m.x,y:m.y},{width:m.width,height:m.height}))return{affected:[],canResize:!1};return{affected:[],canResize:!0}}}function P(a,n,e,l,i,s,r){const{width:c,height:g}=i;if(e.x<0||e.y<0||e.x+l.width>c||e.y+l.height>g)return{valid:!1,affectedComponents:[]};const y=a.find(M=>M.id===n);if(!y)return{valid:!1,affectedComponents:[]};const{affected:h,canResize:m}=ot(a,y,e,l,i,s,r);return{valid:m,affectedComponents:h}}function G(a,n,e,l){const i=a.x<e.x+l.width&&a.x+n.width>e.x,s=a.y<e.y+l.height&&a.y+n.height>e.y;return i&&s}function X(a,n,e,l){const i={...n,x:e.x,y:e.y,width:l.width,height:l.height};for(const s of a)if(s.id!==n.id&&G({x:i.x,y:i.y},{width:i.width,height:i.height},{x:s.x,y:s.y},{width:s.width,height:s.height}))return!0;return!1}function nt(a,n,e,l,i){const{width:s,height:r}=l,c=a.find(h=>h.id===n);if(!c)return{valid:!1,affectedComponents:[],finalPosition:e};const g={width:c.width,height:c.height},y=Z(e,g,a,n,l,i);if(y.x<0||y.y<0||y.x+g.width>s||y.y+g.height>r)return{valid:!1,affectedComponents:[],finalPosition:y};for(const h of a)if(h.id!==n&&G(y,g,{x:h.x,y:h.y},{width:h.width,height:h.height}))return{valid:!1,affectedComponents:[],finalPosition:y};return{valid:!0,affectedComponents:[],finalPosition:y}}function it(a,n,e,l,i,s){if(n.width===e.width)return a;const r=i/l;return a.map(c=>{let g=c.x,y=c.y,h=c.width,m=c.height;if(r!==1){const{gap:M}=s,N=Math.round(c.x/(l+M)),b=Math.max(1,Math.round((c.width+M)/(l+M)));g=N*(i+M),h=b*i+(b-1)*M,h=Math.max(h,i)}if(g+h>e.width){const M=e.width-g;M>0?h=Math.min(h,M):g=Math.max(0,e.width-h)}if(y+m>e.height){const M=e.height-y;M>0&&(m=Math.min(m,M))}return{...c,x:parseFloat(g.toFixed(3)),y:parseFloat(y.toFixed(3)),width:parseFloat(h.toFixed(3)),height:parseFloat(m.toFixed(3))}})}const at={class:"resize-overlay"},st=t.defineComponent({__name:"GridsterItem",props:{component:{},gridConfig:{},containerInfo:{},allComponents:{}},emits:["resize","drag","remove"],setup(a,{emit:n}){const e=a,l=n,i=t.ref(!1),s=t.ref(!1),r=t.ref(""),c=t.ref({x:0,y:0}),g=t.ref({x:0,y:0}),y=t.computed(()=>({position:"absolute",left:`${e.component.x}px`,top:`${e.component.y}px`,width:`${e.component.width}px`,height:`${e.component.height}px`,zIndex:i.value||s.value?100:1,cursor:s.value?h(r.value):"move"})),h=p=>({top:"n-resize",right:"e-resize",bottom:"s-resize",left:"w-resize","top-left":"nw-resize","top-right":"ne-resize","bottom-left":"sw-resize","bottom-right":"se-resize"})[p]||"move",m=(p,o)=>{o.preventDefault(),o.stopPropagation(),H(p,o)},M=(p,o)=>{o.preventDefault(),o.stopPropagation(),H(p,o)},N=p=>{i.value=!0,p.dataTransfer?.setData("text/plain",e.component.id),p.dataTransfer.effectAllowed="move";const o=p.currentTarget;p.dataTransfer?.setDragImage(o,0,0);const u=o.getBoundingClientRect();c.value={x:e.component.x,y:e.component.y},g.value={x:p.clientX-u.left,y:p.clientY-u.top}},b=p=>{if(!i.value)return;const o=p.currentTarget.parentElement?.getBoundingClientRect();if(!o)return;const u=p.clientX-o.left-g.value.x,f=p.clientY-o.top-g.value.y;l("drag",e.component.id,{x:u,y:f})},C=()=>{i.value=!1,c.value={x:0,y:0},g.value={x:0,y:0}},_=()=>e.allComponents?e.allComponents.filter(p=>p.id!==e.component.id):[],d=p=>{const o=_(),u=e.gridConfig.gap;for(const f of o)if(!(e.component.y+e.component.height<=f.y||f.y+f.height<=e.component.y)&&f.x+f.width<=e.component.x&&p-(f.x+f.width)<u)return f.x+f.width+u;return p},x=p=>{const o=_(),u=e.gridConfig.gap;for(const f of o)if(!(e.component.x+e.component.width<=f.x||f.x+f.width<=e.component.x)&&f.y+f.height<=e.component.y&&p-(f.y+f.height)<u)return f.y+f.height+u;return p},H=(p,o)=>{o.preventDefault(),o.stopPropagation();const u=o.clientX,f=o.clientY,w=e.component.width,v=e.component.height,E=e.component.x,k=e.component.y,L=e.containerInfo.width,O=e.containerInfo.height;r.value=p,s.value=!0;const S=D=>{if(D.buttons===0){F();return}const T=D.clientX-u,B=D.clientY-f;let I=w,R=v,W=E,$=k;switch(p){case"right":I=Math.max(e.component.minWidth||100,w+T);break;case"left":I=Math.max(e.component.minWidth||100,w-T),W=E+w-I,W=d(W),I=E+w-W;break;case"bottom":R=Math.max(e.component.minHeight||60,v+B);break;case"top":R=Math.max(e.component.minHeight||60,v-B),$=k+v-R,$=x($),R=k+v-$;break;case"top-right":I=Math.max(e.component.minWidth||100,w+T),R=Math.max(e.component.minHeight||60,v-B),$=k+v-R,$=x($),R=k+v-$;break;case"top-left":I=Math.max(e.component.minWidth||100,w-T),R=Math.max(e.component.minHeight||60,v-B),W=E+w-I,$=k+v-R,W=d(W),$=x($),I=E+w-W,R=k+v-$;break;case"bottom-left":I=Math.max(e.component.minWidth||100,w-T),R=Math.max(e.component.minHeight||60,v+B),W=E+w-I,W=d(W),I=E+w-W;break;case"bottom-right":I=Math.max(e.component.minWidth||100,w+T),R=Math.max(e.component.minHeight||60,v+B);break}W=Math.max(0,W),$=Math.max(0,$),W+I>L&&(p.includes("left")?(W=L-I,W=Math.max(0,W)):I=L-W),$+R>O&&(p.includes("top")?($=O-R,$=Math.max(0,$)):R=O-$),I=Math.max(e.component.minWidth||100,I),R=Math.max(e.component.minHeight||60,R);let V={width:I,height:R};["left","right","top-left","top-right","bottom-left","bottom-right"].includes(p)&&(V=j(e.component,{width:I,height:R},e.gridConfig)),W+V.width>L&&(V.width=L-W),$+V.height>O&&(V.height=O-$),V.width=Math.max(e.component.minWidth||100,V.width),V.height=Math.max(e.component.minHeight||60,V.height),l("resize",e.component.id,{width:parseFloat(V.width.toFixed(3)),height:parseFloat(V.height.toFixed(3)),x:parseFloat(W.toFixed(3)),y:parseFloat($.toFixed(3)),resizeType:p})},F=()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",F),document.removeEventListener("mouseleave",F),s.value=!1,r.value=""};document.addEventListener("mousemove",S),document.addEventListener("mouseup",F),document.addEventListener("mouseleave",F),s.value=!0,r.value=""};return(p,o)=>{const u=t.resolveComponent("icon-delete");return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["gridster-item",{resizing:s.value}]),style:t.normalizeStyle(y.value),draggable:"true",onDragstart:N,onDrag:b,onDragend:C},[t.renderSlot(p.$slots,"default",{},void 0,!0),t.createElementVNode("div",at,[t.createElementVNode("div",{class:"edge top",onMousedown:o[0]||(o[0]=f=>m("top",f))},null,32),t.createElementVNode("div",{class:"edge right",onMousedown:o[1]||(o[1]=f=>m("right",f))},null,32),t.createElementVNode("div",{class:"edge bottom",onMousedown:o[2]||(o[2]=f=>m("bottom",f))},null,32),t.createElementVNode("div",{class:"edge left",onMousedown:o[3]||(o[3]=f=>m("left",f))},null,32),t.createElementVNode("div",{class:"corner top-left",onMousedown:o[4]||(o[4]=f=>M("top-left",f))},null,32),t.createElementVNode("div",{class:"corner top-right",onMousedown:o[5]||(o[5]=f=>M("top-right",f))},null,32),t.createElementVNode("div",{class:"corner bottom-left",onMousedown:o[6]||(o[6]=f=>M("bottom-left",f))},null,32),t.createElementVNode("div",{class:"corner bottom-right",onMousedown:o[7]||(o[7]=f=>M("bottom-right",f))},null,32)]),t.createVNode(u,{size:16,class:"remove-btn",onClick:o[8]||(o[8]=f=>p.$emit("remove",a.component.id))})],38)}}}),A=(a,n)=>{const e=a.__vccOpts||a;for(const[l,i]of n)e[l]=i;return e},Q=A(st,[["__scopeId","data-v-61670cbd"]]),rt={class:"add-container"},lt={class:"component-library"},dt={class:"search-section"},ct={class:"components-grid"},ht=["onClick"],ft={key:0,class:"selection-indicator"},mt={key:0,class:"empty-state"},J=A(t.defineComponent({__name:"AddComponent",props:{componentLibrary:{}},emits:["confirm","cancel"],setup(a,{expose:n,emit:e}){const l=a,i=t.ref(!1),s=t.ref([]),r=e,c=C=>{const _=s.value.findIndex(d=>d.id===C.id);_>-1?s.value.splice(_,1):s.value.push(C)},g=t.ref(""),y=t.computed(()=>{if(!g.value)return l.componentLibrary;const C=g.value.toLowerCase();return l.componentLibrary.filter(_=>_.name.toLowerCase().includes(C))}),h=C=>s.value.some(_=>_.id===C.id),m=C=>{const _={...C,x:0,y:0};c(_)},M=()=>{s.value.length>0&&(N(),r("confirm",s.value),s.value=[])},N=()=>{i.value=!1};return n({open:()=>{i.value=!0},close:N}),(C,_)=>{const d=t.resolveComponent("a-alert"),x=t.resolveComponent("a-input"),H=t.resolveComponent("a-scrollbar"),p=t.resolveComponent("a-modal");return t.openBlock(),t.createBlock(p,{visible:i.value,"onUpdate:visible":_[1]||(_[1]=o=>i.value=o),title:"æ·»åŠ ç»„ä»¶ ",width:"1000px",onOk:M,onCancel:N},{default:t.withCtx(()=>[t.createElementVNode("div",rt,[t.createVNode(d,null,{default:t.withCtx(()=>[t.createTextVNode("å·²é€‰æ‹©ï¼š"+t.toDisplayString(s.value.length),1)]),_:1}),t.createElementVNode("div",lt,[t.createElementVNode("div",dt,[t.createVNode(x,{modelValue:g.value,"onUpdate:modelValue":_[0]||(_[0]=o=>g.value=o),type:"text",placeholder:"æœç´¢ç»„ä»¶...",class:"search-input"},null,8,["modelValue"])]),t.createVNode(H,{style:{height:"500px",overflow:"auto"}},{default:t.withCtx(()=>[t.createElementVNode("div",ct,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(y.value,o=>(t.openBlock(),t.createElementBlock("div",{key:o.id,class:t.normalizeClass(["component-card",{selected:h(o)}]),onClick:u=>m(o)},[t.renderSlot(C.$slots,"component",{component:o},void 0,!0),h(o)?(t.openBlock(),t.createElementBlock("div",ft," âœ“ ")):t.createCommentVNode("",!0)],10,ht))),128))])]),_:3}),y.value.length===0?(t.openBlock(),t.createElementBlock("div",mt," æœªæ‰¾åˆ°åŒ¹é…çš„ç»„ä»¶ ")):t.createCommentVNode("",!0)])])]),_:3},8,["visible"])}}}),[["__scopeId","data-v-e98454be"]]),gt={class:"grid-header"},ut={class:"grid-header_right"},pt={class:"grid-container"},xt={GridDrag:A(t.defineComponent({__name:"GridDrag",props:{componentLibrary:{},addedComponents:{}},emits:["get-container-size","add-component","update:added-components"],setup(a,{emit:n}){const e=a,l=n,i=t.computed({get:()=>e.addedComponents?e.addedComponents:[],set:o=>{l("update:added-components",o)}}),s=t.reactive({gap:10,cellWidth:0}),r=t.reactive({width:0,height:0,scrollTop:0}),c=t.ref(),g=t.computed(()=>r.height),y=()=>{if(!c.value)return;const o=c.value;r.width=o.clientWidth,r.height=o.clientHeight;const u=23*s.gap,f=(r.width-u)/24;s.cellWidth=Math.max(parseFloat(f.toFixed(3)),20)},h=t.computed(()=>({gridTemplateColumns:"repeat(24, minmax(0, 1fr))",gridTemplateRows:"repeat(auto-fit, 100%)",gap:`${s.gap}px`,width:"100%",minHeight:`${g.value}px`})),m=t.computed(()=>({gridTemplateColumns:"repeat(24, minmax(0, 1fr))",gap:`${s.gap}px`,gridTemplateRows:"repeat(auto-fit, 100%)",width:"100%"})),M=()=>{if(!c.value)return;const o=c.value,u=r.width,f=r.height,w=s.cellWidth,v={width:u};r.width=o.clientWidth,r.height=o.clientHeight,y();const E=s.cellWidth;if(u!==r.width||f!==r.height){console.log("å®¹å™¨å°ºå¯¸å˜åŒ–ï¼Œè¿›è¡Œè‡ªé€‚åº”è°ƒæ•´",{oldSize:{width:u,height:f},newSize:{width:r.width,height:r.height},oldCellWidth:w,newCellWidth:E,cellWidthRatio:E/w});const k=i.value.map(O=>({id:O.id,x:O.x,width:O.width}));i.value=it(i.value,v,r,w,E,s);const L=i.value.map(O=>({id:O.id,x:O.x,width:O.width}));console.log("ç»„ä»¶è‡ªé€‚åº”è°ƒæ•´ç»“æžœ",{before:k,after:L})}},N=(o,u)=>{const f=i.value.findIndex(F=>F.id===o);if(f===-1)return;const w=i.value[f],v={width:u.width||w.width,height:u.height||w.height},E={x:u.x!==void 0?u.x:w.x,y:u.y!==void 0?u.y:w.y};let k=v;const L=u.resizeType||"";["left","right","top-left","top-right","bottom-left","bottom-right"].includes(L)&&(k=j(w,v,s));const S=P(i.value,o,E,k,r,s,L);if(S.valid)w.x=E.x,w.y=E.y,w.width=k.width,w.height=k.height,S.affectedComponents.length>0&&S.affectedComponents.forEach(F=>{const D=i.value.find(T=>T.id===F.id);D&&(D.x=F.x,D.y=F.y)});else{const F=P(i.value,o,{x:w.x,y:w.y},k,r,s,L);F.valid&&(w.width=k.width,w.height=k.height,F.affectedComponents.length>0&&F.affectedComponents.forEach(D=>{const T=i.value.find(B=>B.id===D.id);T&&(T.x=D.x,T.y=D.y)}))}},b=(o,u)=>{const f=i.value.find(v=>v.id===o);if(!f)return;const w=nt(i.value,o,u,r,s);w.valid&&(f.x=w.finalPosition.x,f.y=w.finalPosition.y,w.affectedComponents.length>0&&w.affectedComponents.forEach(v=>{const E=i.value.find(k=>k.id===v.id);E&&(E.x=v.x,E.y=v.y)}))},C=o=>{const u=i.value.findIndex(f=>f.id===o);u!==-1&&i.value.splice(u,1)},_=o=>{o.preventDefault(),o.dataTransfer&&(o.dataTransfer.dropEffect="move")};let d=null;t.onMounted(()=>{c.value&&(d=new ResizeObserver(()=>{M()}),d.observe(c.value)),M(),window.addEventListener("resize",M)}),t.onUnmounted(()=>{d&&d.disconnect(),window.removeEventListener("resize",M)}),t.watch(()=>r,()=>l("get-container-size",r),{deep:!0});const x=t.ref(),H=()=>{x.value.open()},p=o=>{let u=0;const f=[];if(o.forEach(w=>{const v=K(i.value,w,r,s);if(v){const E={...w,id:`${w.id}-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,x:v.x,y:v.y};q(E,s),i.value.push(E),u++,console.log(`âœ“ æˆåŠŸæ·»åŠ : ${w.name} ä½ç½®: (${v.x}, ${v.y})`)}else console.warn(`âœ— æ‰¾ä¸åˆ°åˆé€‚ä½ç½®: ${w.name}`),f.push(w.name)}),f.length>0){z.Message.warning(`ä»¥ä¸‹ç»„ä»¶æ— æ³•æ·»åŠ ï¼ˆç©ºé—´ä¸è¶³ï¼‰ï¼š
${f.join(`
`)}`);return}u>0&&console.log(`æˆåŠŸæ·»åŠ  ${u} ä¸ªç»„ä»¶`),x.value.close()};return(o,u)=>{const f=t.resolveComponent("a-button"),w=t.resolveComponent("a-space");return t.openBlock(),t.createElementBlock(t.Fragment,null,[t.createElementVNode("header",gt,[u[1]||(u[1]=t.createElementVNode("div",{class:"grid-header_left"},null,-1)),t.createElementVNode("div",ut,[t.createVNode(w,null,{default:t.withCtx(()=>[t.createVNode(f,{type:"primary",onClick:H},{default:t.withCtx(()=>[...u[0]||(u[0]=[t.createTextVNode("æ·»åŠ ç»„ä»¶",-1)])]),_:1}),t.renderSlot(o.$slots,"extra",{},void 0,!0)]),_:3})])]),t.createElementVNode("div",pt,[t.createElementVNode("div",{ref_key:"gridContainer",ref:c,class:"grid-content",style:t.normalizeStyle(h.value),onDragover:_},[t.createElementVNode("div",{class:"grid-background",style:t.normalizeStyle(m.value)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(24),v=>(t.openBlock(),t.createElementBlock("div",{class:"grid-cell",key:v}))),128))],4),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(a.addedComponents,v=>(t.openBlock(),t.createBlock(Q,{key:v.id,component:v,"grid-config":s,"container-info":r,"all-components":a.addedComponents,onResize:N,onDrag:b,onRemove:C},{default:t.withCtx(()=>[t.renderSlot(o.$slots,"item",{itemData:v},void 0,!0)]),_:2},1032,["component","grid-config","container-info","all-components"]))),128))],36)]),t.createVNode(J,{ref_key:"addComponentRef",ref:x,onConfirm:p,"component-library":e.componentLibrary},t.createSlots({_:2},[t.renderList(Object.keys(o.$slots),v=>({name:v,fn:t.withCtx(E=>[t.renderSlot(o.$slots,v,t.normalizeProps(t.guardReactiveProps(E||{})),void 0,!0)])}))]),1032,["component-library"])],64)}}}),[["__scopeId","data-v-4b3145d3"]]),GridsterItem:Q,AddComponent:J};return{install:a=>{Object.entries(xt).forEach(([n,e])=>{a.component(n,e)})}}}));

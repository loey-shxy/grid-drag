(function(I,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("@arco-design/web-vue")):typeof define=="function"&&define.amd?define(["exports","vue","@arco-design/web-vue"],e):(I=typeof globalThis<"u"?globalThis:I||self,e(I["grid-drag"]={},I.Vue,I.webVue))})(this,(function(I,e,it){"use strict";function Z(a,i,t,h){const{width:s,height:r}=t,{gap:l,cellWidth:c}=h;if(U(i,h),console.log(`üì¶ Â°´ÂÖÖÂêéÁªÑ‰ª∂: ${i.name}, ÂÆΩÂ∫¶: ${i.width}, È´òÂ∫¶: ${i.height}`),i.width>s)return console.warn("ÁªÑ‰ª∂ÂÆΩÂ∫¶Ë∂ÖËøáÂÆπÂô®ÂÆΩÂ∫¶"),null;const g=Math.ceil(i.width/(c+l)),x=Math.min(g,24);console.log(`üìè ÁªÑ‰ª∂Âç†Áî®ÂàóÊï∞: ${g} -> ${x}`);const n=new Array(24).fill(0);for(const d of a){const u=Math.floor(d.x/(c+l)),_=Math.ceil(d.width/(c+l)),y=Math.min(u+_,24),o=d.y+d.height+l;console.log(`üìç Áé∞ÊúâÁªÑ‰ª∂: ${d.name}, ‰ΩçÁΩÆ: (${d.x}, ${d.y}), Â∞∫ÂØ∏: ${d.width}x${d.height}`),console.log(`üìç Âç†Áî®Âàó: ${u} -> ${y} (${_}Âàó), Â∫ïÈÉ®Y: ${o}`);for(let p=u;p<y;p++)p>=0&&p<24&&(n[p]=Math.max(n[p]||0,o))}console.log("üìä ÂàóÈ´òÂ∫¶Êï∞ÁªÑ:",n.slice(0,12));let m=0,w=1/0;for(let d=0;d<=24-x;d++){let u=0;for(let _=d;_<d+x;_++)u=Math.max(u,n[_]||0);u<w&&(w=u,m=d)}const N=m*(c+l),H=w;if(console.log(`üéØ ÊúÄ‰Ω≥‰ΩçÁΩÆ: Âàó${m}, È´òÂ∫¶${w} -> ÂùêÊ†á(${N}, ${H})`),H+i.height>r)return console.warn(`‚ùå ‰ΩçÁΩÆË∂ÖÂá∫ÂÆπÂô®È´òÂ∫¶: ${H+i.height} > ${r}`),null;const C={x:parseFloat(N.toFixed(3)),y:parseFloat(H.toFixed(3))},b={width:i.width,height:i.height};for(const d of a)if(z(C,b,{x:d.x,y:d.y},{width:d.width,height:d.height}))return console.warn("Êñ∞ÁªÑ‰ª∂‰ΩçÁΩÆ‰∏éÁé∞ÊúâÁªÑ‰ª∂ÈáçÂè†"),null;return C}function tt(a,i,t,h,s,r){const{width:l,height:c}=s,{gap:g}=r,n=(l-23*g)/24+g;let m=Math.round(a.x/n);const N=24-Math.ceil(i.width/n);m=Math.max(0,Math.min(m,N));const H=m*n;let C=a.y;const b=t.filter(d=>{if(d.id===h)return!1;const u=H<d.x+d.width&&H+i.width>d.x,_=d.y+d.height<=a.y;return u&&_});if(b.length>0){let d=null,u=1/0;for(const _ of b){const y=a.y-(_.y+_.height);y>=0&&y<u&&(u=y,d=_)}d&&u<=g?(C=d.y+d.height+g,console.log(`È´òÂ∫¶Âê∏ÈôÑ: Ë∑ùÁ¶ª=${u}, Âê∏ÈôÑÂà∞Y=${C}`)):console.log(`‰∏çËøõË°åÈ´òÂ∫¶Âê∏ÈôÑ: Ë∑ùÁ¶ª=${u} > gap=${g}`)}return C+i.height>c&&(C=c-i.height),C=Math.max(0,C),{x:parseFloat(H.toFixed(3)),y:parseFloat(C.toFixed(3))}}function at(a,i,t,h=!1,s=!1){if(a.length===0)return!0;const{gap:r}=t,l=i.width,c=i.height,g=(l-23*r)/24;if(s){for(const n of a)(n.x+n.width>l||n.y+n.height>c)&&(n.x=Math.min(n.x,l-n.width),n.y=Math.min(n.y,c-n.height),n.x=Math.max(0,n.x),n.y=Math.max(0,n.y));return!0}const x=new Array(24).fill(0);for(const n of a){h||U(n,t);const m=Math.ceil(n.width/(g+r)),w=Math.min(m,24);let N=0,H=1/0;for(let b=0;b<=24-w;b++){let d=0;for(let u=b;u<b+w;u++)d=Math.max(d,x[u]||0);d<H&&(H=d,N=b)}if(n.x=parseFloat((N*(g+r)).toFixed(3)),n.y=parseFloat(H.toFixed(3)),n.y+n.height>c)return console.warn("ÁªÑ‰ª∂Ë∂ÖÂá∫ÂÆπÂô®È´òÂ∫¶ÔºåÊó†Ê≥ïÂÆåÊàêÂ∏ÉÂ±Ä"),!1;const C=n.y+n.height+r;for(let b=N;b<N+w;b++)x[b]=C}return!0}function U(a,i){const{cellWidth:t,gap:h}=i,s=a.minWidth||t,r=a.minHeight||60;a.width=Math.max(a.width,s),a.height=Math.max(a.height,r);const l=Math.ceil(a.width/(t+h)),c=Math.min(l,24),g=c*t+(c-1)*h;a.width=parseFloat(g.toFixed(3))}function X(a,i,t){const{gap:h,cellWidth:s}=t,r=a.minWidth||s,l=a.minHeight||60,c=Math.max(i.width,r),g=Math.max(i.height,l),x=Math.ceil(c/(s+h)),n=Math.min(x,24),m=n*s+(n-1)*h,w=Math.max(m,r),N=Math.max(g,l);return{width:parseFloat(w.toFixed(3)),height:parseFloat(N.toFixed(3))}}function P(a,i,t,h,s,r){const l=[],{width:c,height:g}=s,{gap:x}=r,n={...i,x:t.x,y:t.y,width:h.width,height:h.height},m=a.filter(d=>{if(d.id===i.id)return!1;const u=!(n.y+n.height<=d.y||d.y+d.height<=n.y),_=d.x>=i.x+i.width-x;return u&&_});if(m.length===0)return{affected:[],canResize:!0};m.sort((d,u)=>d.x-u.x);const w=n.x+n.width;let N=!1,H=0;for(const d of m){const u=w+x-d.x;if(u>0){N=!0,H=u;break}}if(!N)return{affected:[],canResize:!0};const C=[],b=[];for(const d of m){const u=d.x+H;u+d.width>c?b.push(d):C.push({...d,x:u,y:d.y})}if(b.length>0){const d=[...a.filter(u=>u.id!==i.id&&!m.some(_=>_.id===u.id)),n,...C];b.sort((u,_)=>u.x-_.x);for(const u of b){const _=st(d,u,r);if(_+u.height>g){const y=c-u.width,o={...u,x:y,y:u.y};return C.push(o),d.push(o),{affected:[],canResize:!1}}else{const y={...u,x:u.x,y:_};C.push(y),d.push(y)}}}return l.push(...C),{affected:l,canResize:!0}}function q(a,i,t,h,s,r){const l=[],{height:c}=s,{gap:g}=r,x={...i,x:t.x,y:t.y,width:h.width,height:h.height},n=a.filter(H=>{if(H.id===i.id)return!1;const C=!(x.x+x.width<=H.x||H.x+H.width<=x.x),b=H.y>=i.y+i.height-g;return C&&b});if(n.length===0)return{affected:[],canResize:!0};n.sort((H,C)=>H.y-C.y);const m=x.y+x.height;let w=!1,N=0;for(const H of n){const C=m+g-H.y;if(C>0){w=!0,N=C;break}}if(!w)return{affected:[],canResize:!0};for(const H of n){const C=H.y+N;if(C+H.height>c)return{affected:[],canResize:!1};l.push({...H,x:parseFloat(H.x.toFixed(3)),y:parseFloat(C.toFixed(3))})}return{affected:l,canResize:!0}}function st(a,i,t){const{gap:h}=t;let s=i.y+i.height+h;const r=a.filter(c=>c.id===i.id?!1:!(i.x+i.width<=c.x||c.x+c.width<=i.x));r.sort((c,g)=>c.y-g.y);let l=!1;for(;!l;){l=!0;for(const c of r)if(!(s+i.height<=c.y||c.y+c.height<=s)){s=c.y+c.height+h,l=!1;break}}return s}function rt(a,i,t,h,s,r){const l=P(a,i,t,h,s,r);if(!l.canResize)return l;const c=a.map(m=>{const w=l.affected.find(N=>N.id===m.id);return w?{...m,x:w.x,y:w.y}:m}),g=q(c,i,t,h,s,r);if(!g.canResize)return g;const x=[],n=new Set;for(const m of l.affected)x.push(m),n.add(m.id);for(const m of g.affected)if(!n.has(m.id))x.push(m);else{const w=x.find(N=>N.id===m.id);w&&(w.y=m.y)}return{affected:x,canResize:!0}}function et(a,i,t,h,s,r,l){const c=h.width>i.width,g=h.height>i.height,x=t.x!==i.x||t.y!==i.y;if(x){const n={...i,x:t.x,y:t.y,width:h.width,height:h.height};for(const m of a)if(m.id!==i.id&&z({x:n.x,y:n.y},{width:n.width,height:n.height},{x:m.x,y:m.y},{width:m.width,height:m.height}))return{affected:[],canResize:!1};return{affected:[],canResize:!0}}if(l==="bottom-right"&&c&&g)return rt(a,i,t,h,s,r);if(l==="top-right"&&c&&x)return g?P(a,i,t,h,s,r):{affected:[],canResize:!Q(a,i,t,h)};if(l==="bottom-left"&&g&&x)return c?q(a,i,t,h,s,r):{affected:[],canResize:!Q(a,i,t,h)};if(l==="top-left"&&x)return{affected:[],canResize:!Q(a,i,t,h)};if(c&&(l==="right"||l?.includes("right")))return P(a,i,t,h,s,r);if(g&&(l==="bottom"||l?.includes("bottom")))return q(a,i,t,h,s,r);{const n={...i,x:t.x,y:t.y,width:h.width,height:h.height};for(const m of a)if(m.id!==i.id&&z({x:n.x,y:n.y},{width:n.width,height:n.height},{x:m.x,y:m.y},{width:m.width,height:m.height}))return{affected:[],canResize:!1};return{affected:[],canResize:!0}}}function j(a,i,t,h,s,r,l){const{width:c,height:g}=s;if(t.x<0||t.y<0||t.x+h.width>c||t.y+h.height>g)return{valid:!1,affectedComponents:[]};const x=a.find(w=>w.id===i);if(!x)return{valid:!1,affectedComponents:[]};const{affected:n,canResize:m}=et(a,x,t,h,s,r,l);return{valid:m,affectedComponents:n}}function z(a,i,t,h){const s=a.x<t.x+h.width&&a.x+i.width>t.x,r=a.y<t.y+h.height&&a.y+i.height>t.y;return s&&r}function Q(a,i,t,h){const s={...i,x:t.x,y:t.y,width:h.width,height:h.height};for(const r of a)if(r.id!==i.id&&z({x:s.x,y:s.y},{width:s.width,height:s.height},{x:r.x,y:r.y},{width:r.width,height:r.height}))return!0;return!1}function ot(a,i,t,h,s){const{width:r,height:l}=h,c=a.find(n=>n.id===i);if(!c)return{valid:!1,affectedComponents:[],finalPosition:t};const g={width:c.width,height:c.height},x=tt(t,g,a,i,h,s);if(x.x<0||x.y<0||x.x+g.width>r||x.y+g.height>l)return{valid:!1,affectedComponents:[],finalPosition:x};for(const n of a)if(n.id!==i&&z(x,g,{x:n.x,y:n.y},{width:n.width,height:n.height}))return{valid:!1,affectedComponents:[],finalPosition:x};return{valid:!0,affectedComponents:[],finalPosition:x}}function lt(a,i,t,h,s,r){if(i.width===t.width)return a;const l=s/h;return a.map(c=>{let g=c.x,x=c.y,n=c.width,m=c.height;if(l!==1){const{gap:w}=r,N=Math.round(c.x/(h+w)),H=Math.max(1,Math.round((c.width+w)/(h+w)));g=N*(s+w),n=H*s+(H-1)*w,n=Math.max(n,s)}if(g+n>t.width){const w=t.width-g;w>0?n=Math.min(n,w):g=Math.max(0,t.width-n)}if(x+m>t.height){const w=t.height-x;w>0&&(m=Math.min(m,w))}return{...c,x:parseFloat(g.toFixed(3)),y:parseFloat(x.toFixed(3)),width:parseFloat(n.toFixed(3)),height:parseFloat(m.toFixed(3))}})}const dt={class:"resize-overlay"},ct=e.defineComponent({__name:"GridsterItem",props:{component:{},gridConfig:{},containerInfo:{},allComponents:{}},emits:["resize","drag","remove"],setup(a,{emit:i}){const t=a,h=i,s=e.ref(!1),r=e.ref(!1),l=e.ref(""),c=e.ref({x:0,y:0}),g=e.ref({x:0,y:0}),x=e.computed(()=>({position:"absolute",left:`${t.component.x}px`,top:`${t.component.y}px`,width:`${t.component.width}px`,height:`${t.component.height}px`,zIndex:s.value||r.value?100:1,cursor:r.value?n(l.value):"move"})),n=y=>({top:"n-resize",right:"e-resize",bottom:"s-resize",left:"w-resize","top-left":"nw-resize","top-right":"ne-resize","bottom-left":"sw-resize","bottom-right":"se-resize"})[y]||"move",m=(y,o)=>{o.preventDefault(),o.stopPropagation(),_(y,o)},w=(y,o)=>{o.preventDefault(),o.stopPropagation(),_(y,o)},N=y=>{s.value=!0,y.dataTransfer?.setData("text/plain",t.component.id),y.dataTransfer.effectAllowed="move";const o=y.currentTarget;y.dataTransfer?.setDragImage(o,0,0);const p=o.getBoundingClientRect();c.value={x:t.component.x,y:t.component.y},g.value={x:y.clientX-p.left,y:y.clientY-p.top}},H=y=>{if(!s.value)return;const o=y.currentTarget.parentElement?.getBoundingClientRect();if(!o)return;const p=y.clientX-o.left-g.value.x,f=y.clientY-o.top-g.value.y;h("drag",t.component.id,{x:p,y:f})},C=()=>{s.value=!1,c.value={x:0,y:0},g.value={x:0,y:0}},b=()=>t.allComponents?t.allComponents.filter(y=>y.id!==t.component.id):[],d=y=>{const o=b(),p=t.gridConfig.gap;for(const f of o)if(!(t.component.y+t.component.height<=f.y||f.y+f.height<=t.component.y)&&f.x+f.width<=t.component.x&&y-(f.x+f.width)<p)return f.x+f.width+p;return y},u=y=>{const o=b(),p=t.gridConfig.gap;for(const f of o)if(!(t.component.x+t.component.width<=f.x||f.x+f.width<=t.component.x)&&f.y+f.height<=t.component.y&&y-(f.y+f.height)<p)return f.y+f.height+p;return y},_=(y,o)=>{o.preventDefault(),o.stopPropagation();const p=o.clientX,f=o.clientY,M=t.component.width,v=t.component.height,W=t.component.x,k=t.component.y,S=t.containerInfo.width,O=t.containerInfo.height;l.value=y,r.value=!0;const G=D=>{if(D.buttons===0){L();return}const T=D.clientX-p,B=D.clientY-f;let R=M,F=v,E=W,$=k;switch(y){case"right":R=Math.max(t.component.minWidth||100,M+T);break;case"left":R=Math.max(t.component.minWidth||100,M-T),E=W+M-R,E=d(E),R=W+M-E;break;case"bottom":F=Math.max(t.component.minHeight||60,v+B);break;case"top":F=Math.max(t.component.minHeight||60,v-B),$=k+v-F,$=u($),F=k+v-$;break;case"top-right":R=Math.max(t.component.minWidth||100,M+T),F=Math.max(t.component.minHeight||60,v-B),$=k+v-F,$=u($),F=k+v-$;break;case"top-left":R=Math.max(t.component.minWidth||100,M-T),F=Math.max(t.component.minHeight||60,v-B),E=W+M-R,$=k+v-F,E=d(E),$=u($),R=W+M-E,F=k+v-$;break;case"bottom-left":R=Math.max(t.component.minWidth||100,M-T),F=Math.max(t.component.minHeight||60,v+B),E=W+M-R,E=d(E),R=W+M-E;break;case"bottom-right":R=Math.max(t.component.minWidth||100,M+T),F=Math.max(t.component.minHeight||60,v+B);break}E=Math.max(0,E),$=Math.max(0,$),E+R>S&&(y.includes("left")?(E=S-R,E=Math.max(0,E)):R=S-E),$+F>O&&(y.includes("top")?($=O-F,$=Math.max(0,$)):F=O-$),R=Math.max(t.component.minWidth||100,R),F=Math.max(t.component.minHeight||60,F);let V={width:R,height:F};["left","right","top-left","top-right","bottom-left","bottom-right"].includes(y)&&(V=X(t.component,{width:R,height:F},t.gridConfig)),E+V.width>S&&(V.width=S-E),$+V.height>O&&(V.height=O-$),V.width=Math.max(t.component.minWidth||100,V.width),V.height=Math.max(t.component.minHeight||60,V.height),h("resize",t.component.id,{width:parseFloat(V.width.toFixed(3)),height:parseFloat(V.height.toFixed(3)),x:parseFloat(E.toFixed(3)),y:parseFloat($.toFixed(3)),resizeType:y})},L=()=>{document.removeEventListener("mousemove",G),document.removeEventListener("mouseup",L),document.removeEventListener("mouseleave",L),r.value=!1,l.value=""};document.addEventListener("mousemove",G),document.addEventListener("mouseup",L),document.addEventListener("mouseleave",L),r.value=!0,l.value=""};return(y,o)=>{const p=e.resolveComponent("icon-delete");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["gridster-item",{resizing:r.value}]),style:e.normalizeStyle(x.value),draggable:"true",onDragstart:N,onDrag:H,onDragend:C},[e.renderSlot(y.$slots,"default",{},void 0,!0),e.createElementVNode("div",dt,[e.createElementVNode("div",{class:"edge top",onMousedown:o[0]||(o[0]=f=>m("top",f))},null,32),e.createElementVNode("div",{class:"edge right",onMousedown:o[1]||(o[1]=f=>m("right",f))},null,32),e.createElementVNode("div",{class:"edge bottom",onMousedown:o[2]||(o[2]=f=>m("bottom",f))},null,32),e.createElementVNode("div",{class:"edge left",onMousedown:o[3]||(o[3]=f=>m("left",f))},null,32),e.createElementVNode("div",{class:"corner top-left",onMousedown:o[4]||(o[4]=f=>w("top-left",f))},null,32),e.createElementVNode("div",{class:"corner top-right",onMousedown:o[5]||(o[5]=f=>w("top-right",f))},null,32),e.createElementVNode("div",{class:"corner bottom-left",onMousedown:o[6]||(o[6]=f=>w("bottom-left",f))},null,32),e.createElementVNode("div",{class:"corner bottom-right",onMousedown:o[7]||(o[7]=f=>w("bottom-right",f))},null,32)]),e.createVNode(p,{size:16,class:"remove-btn",onClick:o[8]||(o[8]=f=>y.$emit("remove",a.component.id))})],38)}}}),J=(a,i)=>{const t=a.__vccOpts||a;for(const[h,s]of i)t[h]=s;return t},A=J(ct,[["__scopeId","data-v-61670cbd"]]),ht={class:"add-container"},ft={class:"component-library"},mt={class:"search-section"},gt={class:"components-grid"},ut=["onClick"],pt={key:0,class:"selection-indicator"},xt={key:0,class:"empty-state"},Y=J(e.defineComponent({__name:"AddComponent",props:{componentLibrary:{}},emits:["confirm","cancel"],setup(a,{expose:i,emit:t}){const h=a,s=e.ref(!1),r=e.ref([]),l=t,c=C=>{const b=r.value.findIndex(d=>d.id===C.id);b>-1?r.value.splice(b,1):r.value.push(C)},g=e.ref(""),x=e.computed(()=>{if(!g.value)return h.componentLibrary;const C=g.value.toLowerCase();return h.componentLibrary.filter(b=>b.name.toLowerCase().includes(C))}),n=C=>r.value.some(b=>b.id===C.id),m=C=>{const b={...C,x:0,y:0};c(b)},w=()=>{r.value.length>0&&(N(),l("confirm",r.value),r.value=[])},N=()=>{s.value=!1};return i({open:()=>{s.value=!0},close:N}),(C,b)=>{const d=e.resolveComponent("a-alert"),u=e.resolveComponent("a-input"),_=e.resolveComponent("a-scrollbar"),y=e.resolveComponent("a-modal");return e.openBlock(),e.createBlock(y,{visible:s.value,"onUpdate:visible":b[1]||(b[1]=o=>s.value=o),title:"Ê∑ªÂä†ÁªÑ‰ª∂ ",width:"1000px",onOk:w,onCancel:N},{default:e.withCtx(()=>[e.createElementVNode("div",ht,[e.createVNode(d,null,{default:e.withCtx(()=>[e.createTextVNode("Â∑≤ÈÄâÊã©Ôºö"+e.toDisplayString(r.value.length),1)]),_:1}),e.createElementVNode("div",ft,[e.createElementVNode("div",mt,[e.createVNode(u,{modelValue:g.value,"onUpdate:modelValue":b[0]||(b[0]=o=>g.value=o),type:"text",placeholder:"ÊêúÁ¥¢ÁªÑ‰ª∂...",class:"search-input"},null,8,["modelValue"])]),e.createVNode(_,{style:{height:"500px",overflow:"auto"}},{default:e.withCtx(()=>[e.createElementVNode("div",gt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(x.value,o=>(e.openBlock(),e.createElementBlock("div",{key:o.id,class:e.normalizeClass(["component-card",{selected:n(o)}]),onClick:p=>m(o)},[e.renderSlot(C.$slots,"component",{component:o},void 0,!0),n(o)?(e.openBlock(),e.createElementBlock("div",pt," ‚úì ")):e.createCommentVNode("",!0)],10,ut))),128))])]),_:3}),x.value.length===0?(e.openBlock(),e.createElementBlock("div",xt," Êú™ÊâæÂà∞ÂåπÈÖçÁöÑÁªÑ‰ª∂ ")):e.createCommentVNode("",!0)])])]),_:3},8,["visible"])}}}),[["__scopeId","data-v-e98454be"]]),yt={class:"grid-header"},wt={class:"grid-header_right"},Mt={class:"grid-container"},K=J(e.defineComponent({__name:"GridDrag",props:{componentLibrary:{},addedComponents:{}},emits:["get-container-size","add-component","update:added-components"],setup(a,{emit:i}){const t=a,h=i,s=e.computed({get:()=>t.addedComponents?t.addedComponents:[],set:o=>{h("update:added-components",o)}}),r=e.reactive({gap:10,cellWidth:0}),l=e.reactive({width:0,height:0,scrollTop:0}),c=e.ref(),g=e.computed(()=>l.height),x=()=>{if(!c.value)return;const o=c.value;l.width=o.clientWidth,l.height=o.clientHeight;const p=23*r.gap,f=(l.width-p)/24;r.cellWidth=Math.max(parseFloat(f.toFixed(3)),20)},n=e.computed(()=>({gridTemplateColumns:"repeat(24, minmax(0, 1fr))",gridTemplateRows:"repeat(auto-fit, 100%)",gap:`${r.gap}px`,width:"100%",minHeight:`${g.value}px`})),m=e.computed(()=>({gridTemplateColumns:"repeat(24, minmax(0, 1fr))",gap:`${r.gap}px`,gridTemplateRows:"repeat(auto-fit, 100%)",width:"100%"})),w=()=>{if(!c.value)return;const o=c.value,p=l.width,f=l.height,M=r.cellWidth,v={width:p};l.width=o.clientWidth,l.height=o.clientHeight,x();const W=r.cellWidth;if(p!==l.width||f!==l.height){console.log("ÂÆπÂô®Â∞∫ÂØ∏ÂèòÂåñÔºåËøõË°åËá™ÈÄÇÂ∫îË∞ÉÊï¥",{oldSize:{width:p,height:f},newSize:{width:l.width,height:l.height},oldCellWidth:M,newCellWidth:W,cellWidthRatio:W/M});const k=s.value.map(O=>({id:O.id,x:O.x,width:O.width}));s.value=lt(s.value,v,l,M,W,r);const S=s.value.map(O=>({id:O.id,x:O.x,width:O.width}));console.log("ÁªÑ‰ª∂Ëá™ÈÄÇÂ∫îË∞ÉÊï¥ÁªìÊûú",{before:k,after:S})}},N=(o,p)=>{const f=s.value.findIndex(L=>L.id===o);if(f===-1)return;const M=s.value[f],v={width:p.width||M.width,height:p.height||M.height},W={x:p.x!==void 0?p.x:M.x,y:p.y!==void 0?p.y:M.y};let k=v;const S=p.resizeType||"";["left","right","top-left","top-right","bottom-left","bottom-right"].includes(S)&&(k=X(M,v,r));const G=j(s.value,o,W,k,l,r,S);if(G.valid)M.x=W.x,M.y=W.y,M.width=k.width,M.height=k.height,G.affectedComponents.length>0&&G.affectedComponents.forEach(L=>{const D=s.value.find(T=>T.id===L.id);D&&(D.x=L.x,D.y=L.y)});else{const L=j(s.value,o,{x:M.x,y:M.y},k,l,r,S);L.valid&&(M.width=k.width,M.height=k.height,L.affectedComponents.length>0&&L.affectedComponents.forEach(D=>{const T=s.value.find(B=>B.id===D.id);T&&(T.x=D.x,T.y=D.y)}))}},H=(o,p)=>{const f=s.value.find(v=>v.id===o);if(!f)return;const M=ot(s.value,o,p,l,r);M.valid&&(f.x=M.finalPosition.x,f.y=M.finalPosition.y,M.affectedComponents.length>0&&M.affectedComponents.forEach(v=>{const W=s.value.find(k=>k.id===v.id);W&&(W.x=v.x,W.y=v.y)}))},C=o=>{const p=s.value.findIndex(f=>f.id===o);p!==-1&&s.value.splice(p,1)},b=o=>{o.preventDefault(),o.dataTransfer&&(o.dataTransfer.dropEffect="move")};let d=null;e.onMounted(()=>{c.value&&(d=new ResizeObserver(()=>{w()}),d.observe(c.value)),w(),window.addEventListener("resize",w)}),e.onUnmounted(()=>{d&&d.disconnect(),window.removeEventListener("resize",w)}),e.watch(()=>l,()=>h("get-container-size",l),{deep:!0});const u=e.ref(),_=()=>{u.value.open()},y=o=>{let p=0;const f=[];if(o.forEach(M=>{const v=Z(s.value,M,l,r);if(v){const W={...M,id:`${M.id}-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,x:v.x,y:v.y};U(W,r),s.value.push(W),p++,console.log(`‚úì ÊàêÂäüÊ∑ªÂä†: ${M.name} ‰ΩçÁΩÆ: (${v.x}, ${v.y})`)}else console.warn(`‚úó Êâæ‰∏çÂà∞ÂêàÈÄÇ‰ΩçÁΩÆ: ${M.name}`),f.push(M.name)}),f.length>0){it.Message.warning(`‰ª•‰∏ãÁªÑ‰ª∂Êó†Ê≥ïÊ∑ªÂä†ÔºàÁ©∫Èó¥‰∏çË∂≥ÔºâÔºö
${f.join(`
`)}`);return}p>0&&console.log(`ÊàêÂäüÊ∑ªÂä† ${p} ‰∏™ÁªÑ‰ª∂`),u.value.close()};return(o,p)=>{const f=e.resolveComponent("a-button"),M=e.resolveComponent("a-space");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("header",yt,[p[1]||(p[1]=e.createElementVNode("div",{class:"grid-header_left"},null,-1)),e.createElementVNode("div",wt,[e.createVNode(M,null,{default:e.withCtx(()=>[e.createVNode(f,{type:"primary",onClick:_},{default:e.withCtx(()=>[...p[0]||(p[0]=[e.createTextVNode("Ê∑ªÂä†ÁªÑ‰ª∂",-1)])]),_:1}),e.renderSlot(o.$slots,"extra",{},void 0,!0)]),_:3})])]),e.createElementVNode("div",Mt,[e.createElementVNode("div",{ref_key:"gridContainer",ref:c,class:"grid-content",style:e.normalizeStyle(n.value),onDragover:b},[e.createElementVNode("div",{class:"grid-background",style:e.normalizeStyle(m.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(24),v=>(e.openBlock(),e.createElementBlock("div",{class:"grid-cell",key:v}))),128))],4),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.addedComponents,v=>(e.openBlock(),e.createBlock(A,{key:v.id,component:v,"grid-config":r,"container-info":l,"all-components":a.addedComponents,onResize:N,onDrag:H,onRemove:C},{default:e.withCtx(()=>[e.renderSlot(o.$slots,"item",{itemData:v},void 0,!0)]),_:2},1032,["component","grid-config","container-info","all-components"]))),128))],36)]),e.createVNode(Y,{ref_key:"addComponentRef",ref:u,onConfirm:y,"component-library":t.componentLibrary},e.createSlots({_:2},[e.renderList(Object.keys(o.$slots),v=>({name:v,fn:e.withCtx(W=>[e.renderSlot(o.$slots,v,e.normalizeProps(e.guardReactiveProps(W||{})),void 0,!0)])}))]),1032,["component-library"])],64)}}}),[["__scopeId","data-v-4b3145d3"]]);function nt(a){a.component("GridDrag",K),a.component("GridsterItem",A),a.component("AddComponent",Y)}const Ct={install:nt,GridDrag:K,GridsterItem:A,AddComponent:Y};I.AddComponent=Y,I.COLUMNS=24,I.GridDrag=K,I.GridsterItem=A,I.autoFillComponentToGrid=U,I.default=Ct,I.findAvailablePosition=Z,I.getAffectedComponents=et,I.install=nt,I.reorganizeLayout=at,I.resizeComponentWithAutoFill=X,I.snapToColumnGridWithSmartHeight=tt,I.validateDragPosition=ot,I.validatePositionWithLayout=j,Object.defineProperties(I,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
